<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <title>シリーズおよび時系列データを F# で扱う
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Easy to use .NET library for data manipulation and scientific programming">
    <meta name="author" content="BlueMountain Capital">

    <script src="http://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="http://code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet">

    <link type="text/css" rel="stylesheet" href="/Deedle/ja/../content/style.css" />
    <link type="text/css" rel="stylesheet" href="/Deedle/ja/../content/deedle.css" />
    <script type="text/javascript" src="/Deedle/ja/../content/tips.js"></script>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">
      <div class="masthead">
        <ul class="nav nav-pills pull-right">
          <li><a href="http://fsharp.org">fsharp.org</a></li>
          <li><a href="http://fsharp.github.io/FSharp.Data"><img height="16" width="16" src="http://fsharp.org/images/thumbs/FSharp.Data.png" /> F# Data</a></li>
          <li><a href="http://bluemountaincapital.github.io/FSharpRProvider"><img height=" 16" width="16" src="http://fsharp.org/images/thumbs/FSharpRProvider.png" /> R Provider</a></li>
          <li><a href="http://fsharp.github.io/FSharp.Charting/"><img height="16" width="16" src="http://fsharp.org/images/thumbs/FSharp.Charting.png" /> F# Charting</a></li>
        </ul>
        <h3 class="muted"><a href="/Deedle/ja/index.html">Deedle</a></h3>
      </div>
      <hr />
      <div class="row">
        <div class="span9" id="main">
          
<h1>シリーズおよび時系列データを F# で扱う</h1>

<p>このセクションでは時系列データ、あるいはさらに汎用的に、
任意の順序付きシリーズデータを扱うための
F# データフレームライブラリの機能について説明します。
主には <code>Series</code> 型の操作について説明しますが、
ほとんどは複数のシリーズを含むデータフレームを表す <code>Frame</code> 型でも
利用出来ます。
さらに、データフレームにはアライメントやシリーズの連結を行うための
すばらしい機能も用意されています。</p>

<p>このページをGitHubから
<a href="https://github.com/BlueMountainCapital/Deedle/blob/master/docs/content/series.fsx">F#スクリプトファイル</a>
としてダウンロードして、インタラクティブに実行することもできます。</p>

<h2>入力データの生成</h2>

<p>このチュートリアル用にいくつか入力データを用意します。
簡単のために、ここでは幾何ブラウン運動を使用して
ランダムな価格を生成する、以下のような関数を使用します。
このコードは
<a href="http://www.tryfsharp.org/Learn/financial-computing#simulating-and-analyzing">Try F#のファイナンス用チュートリアル</a>
から抜粋したものです。</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// 確率分布の計算のために Math.NET を使用します</span>
<span class="prep">#r</span> <span class="s">&quot;</span><span class="s">MathNet</span><span class="s">.</span><span class="s">Numerics</span><span class="s">.</span><span class="s">dll</span><span class="s">&quot;</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="i">MathNet</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="i">Numerics</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs3', 3)" onmouseover="showTip(event, 'fs3', 3)" class="i">Distributions</span>

<span class="c">/// 幾何ブラウン運動を使用して価格を生成します</span>
<span class="c">///  - &#39;seed&#39; には乱数生成器のシードを指定します</span>
<span class="c">///  - &#39;drift&#39; と &#39;volatility&#39; には価格変動の特性を設定します</span>
<span class="c">///  - &#39;initial&#39; と &#39;start&#39; には初期の価格と日付を指定します</span>
<span class="c">///  - &#39;span&#39; にはそれぞれの測定の間隔を指定します</span>
<span class="c">///  - &#39;count&#39; には生成する値の個数を指定します</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs4', 4)" onmouseover="showTip(event, 'fs4', 4)" class="i">randomPrice</span> <span onmouseout="hideTip(event, 'fs5', 5)" onmouseover="showTip(event, 'fs5', 5)" class="i">seed</span> <span onmouseout="hideTip(event, 'fs6', 6)" onmouseover="showTip(event, 'fs6', 6)" class="i">drift</span> <span onmouseout="hideTip(event, 'fs7', 7)" onmouseover="showTip(event, 'fs7', 7)" class="i">volatility</span> <span onmouseout="hideTip(event, 'fs8', 8)" onmouseover="showTip(event, 'fs8', 8)" class="i">initial</span> <span onmouseout="hideTip(event, 'fs9', 9)" onmouseover="showTip(event, 'fs9', 9)" class="i">start</span> <span onmouseout="hideTip(event, 'fs10', 10)" onmouseover="showTip(event, 'fs10', 10)" class="i">span</span> <span onmouseout="hideTip(event, 'fs11', 11)" onmouseover="showTip(event, 'fs11', 11)" class="i">count</span> <span class="o">=</span> 
  <span id="fst12" onmouseout="hideTip(event, 'fs12', 12)" onmouseover="showTip(event, 'fs12', 12, document.getElementById('fst12'))" class="omitted">(実装については省略)</span>

<span class="c">// 現在のタイムゾーンにおける本日午前 12:00 のデータ</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs13', 13)" onmouseover="showTip(event, 'fs13', 13)" class="i">today</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs14', 14)" onmouseover="showTip(event, 'fs14', 14)" class="i">DateTimeOffset</span>(<span onmouseout="hideTip(event, 'fs15', 15)" onmouseover="showTip(event, 'fs15', 15)" class="i">DateTime</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs16', 16)" onmouseover="showTip(event, 'fs16', 16)" class="i">Today</span>)
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs17', 17)" onmouseover="showTip(event, 'fs17', 17)" class="i">stock1</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs4', 18)" onmouseover="showTip(event, 'fs4', 18)" class="i">randomPrice</span> <span class="n">1</span> <span class="n">0.1</span> <span class="n">3.0</span> <span class="n">20.0</span> <span onmouseout="hideTip(event, 'fs13', 19)" onmouseover="showTip(event, 'fs13', 19)" class="i">today</span> 
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs18', 20)" onmouseover="showTip(event, 'fs18', 20)" class="i">stock2</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs4', 21)" onmouseover="showTip(event, 'fs4', 21)" class="i">randomPrice</span> <span class="n">2</span> <span class="n">0.2</span> <span class="n">1.5</span> <span class="n">22.0</span> <span onmouseout="hideTip(event, 'fs13', 22)" onmouseover="showTip(event, 'fs13', 22)" class="i">today</span></pre>
</td>
</tr>
</table>

<p>この関数の実装についてはこのページの目的からすると重要では無いので省略していますが、
<a href="https://github.com/BlueMountainCapital/Deedle/blob/master/docs/content/series.fsx">完全なコードを含んだスクリプトファイル</a>
には実際のコードがあります。</p>

<p>この関数を定義した後、(本日の真夜中を表す) <code>today</code> という日付データと、
基本的な性質を設定して <code>randomPrice</code> を呼び出す2つのヘルパ関数を定義しています。</p>

<p>そのため <code>TimeSpan</code> と、必要になる価格の個数を指定して
<code>stock1</code> と <code>stock2</code> を呼び出すだけでランダムな価格を取得することができます：</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span onmouseout="hideTip(event, 'fs19', 23)" onmouseover="showTip(event, 'fs19', 23)" class="i">Chart</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs20', 24)" onmouseover="showTip(event, 'fs20', 24)" class="i">Combine</span>
  [ <span onmouseout="hideTip(event, 'fs17', 25)" onmouseover="showTip(event, 'fs17', 25)" class="i">stock1</span> (<span onmouseout="hideTip(event, 'fs21', 26)" onmouseover="showTip(event, 'fs21', 26)" class="i">TimeSpan</span>(<span class="n">0</span>, <span class="n">1</span>, <span class="n">0</span>)) <span class="n">1000</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs19', 27)" onmouseover="showTip(event, 'fs19', 27)" class="i">Chart</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs22', 28)" onmouseover="showTip(event, 'fs22', 28)" class="i">FastLine</span>
    <span onmouseout="hideTip(event, 'fs18', 29)" onmouseover="showTip(event, 'fs18', 29)" class="i">stock2</span> (<span onmouseout="hideTip(event, 'fs21', 30)" onmouseover="showTip(event, 'fs21', 30)" class="i">TimeSpan</span>(<span class="n">0</span>, <span class="n">1</span>, <span class="n">0</span>)) <span class="n">1000</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs19', 31)" onmouseover="showTip(event, 'fs19', 31)" class="i">Chart</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs22', 32)" onmouseover="showTip(event, 'fs22', 32)" class="i">FastLine</span> ]</pre>
</td>
</tr>
</table>

<p>このスニペットでは1分間隔で1000個の価格データを生成した後、
<a href="https://github.com/fsharp/FSharp.Charting">F# Chartingライブラリ</a>
を使用してそれらを表にプロットしています。
このコードを実行してチャートを確認するとおよそ以下のようなものになっているはずです：</p>

<p><img src="/Deedle/ja\../images/chart3.png" alt="Chart" /></p>

<a name="alignment"></a>

<h2>データアライメントとジップ</h2>

<p>データフレームライブラリの主要な機能の1つとして、
複数キーを元にした時系列データの <strong>自動アライメント (automatic alignment)</strong>
があります。
複数の時系列データがキーになっているデータがあるとすると
(今回は <code>DateTimeOffset</code> ですが、任意の型が使用できます)、
複数のシリーズを連結して特定の日付キーでそれらをアラインすることができます。</p>

<p>この機能を紹介するために、60分、30分、65分間隔のランダムな価格を生成します：</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs23', 33)" onmouseover="showTip(event, 'fs23', 33)" class="i">s1</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs24', 34)" onmouseover="showTip(event, 'fs24', 34)" class="i">series</span> <span class="o">&lt;|</span> <span onmouseout="hideTip(event, 'fs17', 35)" onmouseover="showTip(event, 'fs17', 35)" class="i">stock1</span> (<span onmouseout="hideTip(event, 'fs21', 36)" onmouseover="showTip(event, 'fs21', 36)" class="i">TimeSpan</span>(<span class="n">1</span>, <span class="n">0</span>, <span class="n">0</span>)) <span class="n">6</span>
<span class="fsi">val s1 : Series&lt;DateTimeOffset,float&gt; =</span>
<span class="fsi">  series [ 12:00:00 AM =&gt; 20.76; 1:00:00 AM =&gt; 21.11; 2:00:00 AM =&gt; 22.51 </span>
<span class="fsi">            3:00:00 AM =&gt; 23.88; 4:00:00 AM =&gt; 23.23; 5:00:00 AM =&gt; 22.68 ] </span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs25', 37)" onmouseover="showTip(event, 'fs25', 37)" class="i">s2</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs24', 38)" onmouseover="showTip(event, 'fs24', 38)" class="i">series</span> <span class="o">&lt;|</span> <span onmouseout="hideTip(event, 'fs18', 39)" onmouseover="showTip(event, 'fs18', 39)" class="i">stock2</span> (<span onmouseout="hideTip(event, 'fs21', 40)" onmouseover="showTip(event, 'fs21', 40)" class="i">TimeSpan</span>(<span class="n">0</span>, <span class="n">30</span>, <span class="n">0</span>)) <span class="n">12</span>
<span class="fsi">val s2 : Series&lt;DateTimeOffset,float&gt; =</span>
<span class="fsi">  series [ 12:00:00 AM =&gt; 21.61; 12:30:00 AM =&gt; 21.64; 1:00:00 AM =&gt; 21.86 </span>
<span class="fsi">            1:30:00 AM =&gt; 22.22;  2:00:00 AM =&gt; 22.35; 2:30:00 AM =&gt; 22.76 </span>
<span class="fsi">            3:00:00 AM =&gt; 22.68;  3:30:00 AM =&gt; 22.64; 4:00:00 AM =&gt; 22.90 </span>
<span class="fsi">            4:30:00 AM =&gt; 23.40;  5:00:00 AM =&gt; 23.33; 5:30:00 AM =&gt; 23.43] </span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs26', 41)" onmouseover="showTip(event, 'fs26', 41)" class="i">s3</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs24', 42)" onmouseover="showTip(event, 'fs24', 42)" class="i">series</span> <span class="o">&lt;|</span> <span onmouseout="hideTip(event, 'fs17', 43)" onmouseover="showTip(event, 'fs17', 43)" class="i">stock1</span> (<span onmouseout="hideTip(event, 'fs21', 44)" onmouseover="showTip(event, 'fs21', 44)" class="i">TimeSpan</span>(<span class="n">1</span>, <span class="n">5</span>, <span class="n">0</span>)) <span class="n">6</span>
<span class="fsi">val s3 : Series&lt;DateTimeOffset,float&gt; =</span>
<span class="fsi">  series [ 12:00:00 AM =&gt; 21.37; 1:05:00 AM =&gt; 22.73; 2:10:00 AM =&gt; 22.08 </span>
<span class="fsi">            3:15:00 AM =&gt; 23.92; 4:20:00 AM =&gt; 22.72; 5:25:00 AM =&gt; 22.79 </span></pre>
</td>
</tr>
</table>

<h3>時系列の結合</h3>

<p>まずは <code>Series&lt;K, V&gt;</code> に対して利用出来る操作を紹介します。
シリーズには2つのシリーズをペアにして1つのシリーズとする <code>Zip</code>
操作が用意されています。
これは(後ほど説明する)データフレームではそれほど便利ではないのですが、
値無しを含まない1つまたは2つの列を処理する場合には便利なものです：</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// 左側のシリーズのキーと右側のシリーズの値をマッチさせます</span>
<span class="c">// (それにより値無しを含まないシリーズが作成されます)</span>
<span onmouseout="hideTip(event, 'fs23', 45)" onmouseover="showTip(event, 'fs23', 45)" class="i">s1</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs27', 46)" onmouseover="showTip(event, 'fs27', 46)" class="i">Zip</span>(<span onmouseout="hideTip(event, 'fs25', 47)" onmouseover="showTip(event, 'fs25', 47)" class="i">s2</span>, <span onmouseout="hideTip(event, 'fs28', 48)" onmouseover="showTip(event, 'fs28', 48)" class="i">JoinKind</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs29', 49)" onmouseover="showTip(event, 'fs29', 49)" class="i">Left</span>)
<span class="fsi">val it : Series&lt;DateTimeOffset,float opt * float opt&gt;</span>
<span class="fsi">  12:00:00 AM -&gt; (21.32, 21.61) </span>
<span class="fsi">   1:00:00 AM -&gt; (22.62, 21.86) </span>
<span class="fsi">   2:00:00 AM -&gt; (22.00, 22.35)  </span>
<span class="fsi">  (...)</span>

<span class="c">// 右側のシリーズのキーと左側のシリーズの値をマッチさせます</span>
<span class="c">// (右側のほうが精度が高いため、左側の値の半分が値無しになります)</span>
<span onmouseout="hideTip(event, 'fs23', 50)" onmouseover="showTip(event, 'fs23', 50)" class="i">s1</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs27', 51)" onmouseover="showTip(event, 'fs27', 51)" class="i">Zip</span>(<span onmouseout="hideTip(event, 'fs25', 52)" onmouseover="showTip(event, 'fs25', 52)" class="i">s2</span>, <span onmouseout="hideTip(event, 'fs28', 53)" onmouseover="showTip(event, 'fs28', 53)" class="i">JoinKind</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs30', 54)" onmouseover="showTip(event, 'fs30', 54)" class="i">Right</span>)
<span class="fsi">val it : Series&lt;DateTimeOffset,float opt * float opt&gt;</span>
<span class="fsi">  12:00:00 AM -&gt; (21.32,     21.61) </span>
<span class="fsi">  12:30:00 AM -&gt; (&lt;missing&gt;, 21.64)  </span>
<span class="fsi">   1:00:00 AM -&gt; (22.62,     21.86) </span>
<span class="fsi">  (...)</span>

<span class="c">// 左側のシリーズのキーを使用して、右側のシリーズから最も近い以前の</span>
<span class="c">// (値として小さな)値を見つけるようにします</span>
<span onmouseout="hideTip(event, 'fs23', 55)" onmouseover="showTip(event, 'fs23', 55)" class="i">s1</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs27', 56)" onmouseover="showTip(event, 'fs27', 56)" class="i">Zip</span>(<span onmouseout="hideTip(event, 'fs25', 57)" onmouseover="showTip(event, 'fs25', 57)" class="i">s2</span>, <span onmouseout="hideTip(event, 'fs28', 58)" onmouseover="showTip(event, 'fs28', 58)" class="i">JoinKind</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs29', 59)" onmouseover="showTip(event, 'fs29', 59)" class="i">Left</span>, <span onmouseout="hideTip(event, 'fs31', 60)" onmouseover="showTip(event, 'fs31', 60)" class="i">Lookup</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs32', 61)" onmouseover="showTip(event, 'fs32', 61)" class="i">ExactOrSmaller</span>)
<span class="fsi">val it : Series&lt;DateTimeOffset,float opt * float opt&gt;</span>
<span class="fsi">  12:00:00 AM -04:00 -&gt; (21.32, 21.61) </span>
<span class="fsi">   1:00:00 AM -04:00 -&gt; (22.62, 21.86) </span>
<span class="fsi">   2:00:00 AM -04:00 -&gt; (22.00, 22.35)  </span>
<span class="fsi">  (...)</span></pre>
</td>
</tr>
</table>

<p>シリーズに対して <code>Zip</code> を呼び出した結果はやや複雑なものになります。
結果はシリーズのタプルになるのですが、各タプルの要素は値無しになることがあります。
このことを表現するために、ライブラリでは <code>T opt</code> という型を使用しています
(<code>OptionalValue&lt;T&gt;</code> の型エイリアスです)。
この値はデータフレームを使用して複数の列を扱う場合には不要なものです。</p>

<h3>データフレームの連結</h3>

<p>データをデータフレームに格納する際、タプルを使用して組み合わされた値を
表現する必要はありません。
そのかわり、単に複数の列を持ったデータフレームを使用できます。
具体的な動作を紹介するために、まずは以前のセクションで用意した3つのシリーズを含んだ
3つのデータフレームを用意します：</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// 1時間毎の値を含みます</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs33', 62)" onmouseover="showTip(event, 'fs33', 62)" class="i">f1</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs34', 63)" onmouseover="showTip(event, 'fs34', 63)" class="i">Frame</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs35', 64)" onmouseover="showTip(event, 'fs35', 64)" class="i">ofColumns</span> [<span class="s">&quot;</span><span class="s">S1</span><span class="s">&quot;</span> <span class="o">=&gt;</span> <span onmouseout="hideTip(event, 'fs23', 65)" onmouseover="showTip(event, 'fs23', 65)" class="i">s1</span>]
<span class="c">// 30分毎の値を含みます</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs36', 66)" onmouseover="showTip(event, 'fs36', 66)" class="i">f2</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs34', 67)" onmouseover="showTip(event, 'fs34', 67)" class="i">Frame</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs35', 68)" onmouseover="showTip(event, 'fs35', 68)" class="i">ofColumns</span> [<span class="s">&quot;</span><span class="s">S2</span><span class="s">&quot;</span> <span class="o">=&gt;</span> <span onmouseout="hideTip(event, 'fs25', 69)" onmouseover="showTip(event, 'fs25', 69)" class="i">s2</span>]
<span class="c">// 65分毎の値を含みます</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs37', 70)" onmouseover="showTip(event, 'fs37', 70)" class="i">f3</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs34', 71)" onmouseover="showTip(event, 'fs34', 71)" class="i">Frame</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs35', 72)" onmouseover="showTip(event, 'fs35', 72)" class="i">ofColumns</span> [<span class="s">&quot;</span><span class="s">S3</span><span class="s">&quot;</span> <span class="o">=&gt;</span> <span onmouseout="hideTip(event, 'fs26', 73)" onmouseover="showTip(event, 'fs26', 73)" class="i">s3</span>]</pre>
</td>
</tr>
</table>

<p><code>Series&lt;K, V&gt;</code> と同じく、 <code>Frame&lt;R, C&gt;</code> には
(順序づけられていないデータに対する)ジョイン、
あるいは(順序付きデータに対する)アラインを行う <code>Join</code> メソッドが用意されています。
同じ機能が <code>Frame.join</code> や <code>Frame.joinAlign</code> 関数として定義されていますが、
今回の場合にはメンバーメソッドの文法を使用したほうが簡単です：</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
<span class="l">27: </span>
<span class="l">28: </span>
<span class="l">29: </span>
<span class="l">30: </span>
<span class="l">31: </span>
<span class="l">32: </span>
<span class="l">33: </span>
<span class="l">34: </span>
<span class="l">35: </span>
<span class="l">36: </span>
<span class="l">37: </span>
<span class="l">38: </span>
<span class="l">39: </span>
<span class="l">40: </span>
<span class="l">41: </span>
<span class="l">42: </span>
<span class="l">43: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// 両方のフレームのキーを結合して、対応する値でアラインします</span>
<span onmouseout="hideTip(event, 'fs33', 74)" onmouseover="showTip(event, 'fs33', 74)" class="i">f1</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs38', 75)" onmouseover="showTip(event, 'fs38', 75)" class="i">Join</span>(<span onmouseout="hideTip(event, 'fs36', 76)" onmouseover="showTip(event, 'fs36', 76)" class="i">f2</span>, <span onmouseout="hideTip(event, 'fs28', 77)" onmouseover="showTip(event, 'fs28', 77)" class="i">JoinKind</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs39', 78)" onmouseover="showTip(event, 'fs39', 78)" class="i">Outer</span>)
<span class="fsi">val it : Frame&lt;DateTimeOffset,string&gt; =</span>
<span class="fsi">                 S1        S2               </span>
<span class="fsi">  12:00:00 AM -&gt; 21.32     21.61 </span>
<span class="fsi">  12:30:00 AM -&gt; &lt;missing&gt; 21.64 </span>
<span class="fsi">   1:00:00 AM -&gt; 22.62     21.86 </span>
<span class="fsi">  (...)</span>

<span class="c">// 両方のフレームが値を持つキーだけを取得します</span>
<span class="c">// (&#39;f3&#39; は5分ずつずれているため1行しか取得できません)</span>
<span onmouseout="hideTip(event, 'fs36', 79)" onmouseover="showTip(event, 'fs36', 79)" class="i">f2</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs38', 80)" onmouseover="showTip(event, 'fs38', 80)" class="i">Join</span>(<span onmouseout="hideTip(event, 'fs37', 81)" onmouseover="showTip(event, 'fs37', 81)" class="i">f3</span>, <span onmouseout="hideTip(event, 'fs28', 82)" onmouseover="showTip(event, 'fs28', 82)" class="i">JoinKind</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs40', 83)" onmouseover="showTip(event, 'fs40', 83)" class="i">Inner</span>)
<span class="fsi">val it : Frame&lt;DateTimeOffset,string&gt; =</span>
<span class="fsi">                 S2      S3               </span>
<span class="fsi">  12:00:00 AM -&gt; 21.61   21.37 </span>

<span class="c">// 左のフレームのキーを取得して、右のフレームから対応する、または</span>
<span class="c">// 最も近い小さな日付の値を取得します</span>
<span class="c">// (12:00 から 1:05にかけて 21.37 ドルが繰り返されます)</span>
<span onmouseout="hideTip(event, 'fs36', 84)" onmouseover="showTip(event, 'fs36', 84)" class="i">f2</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs38', 85)" onmouseover="showTip(event, 'fs38', 85)" class="i">Join</span>(<span onmouseout="hideTip(event, 'fs37', 86)" onmouseover="showTip(event, 'fs37', 86)" class="i">f3</span>, <span onmouseout="hideTip(event, 'fs28', 87)" onmouseover="showTip(event, 'fs28', 87)" class="i">JoinKind</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs29', 88)" onmouseover="showTip(event, 'fs29', 88)" class="i">Left</span>, <span onmouseout="hideTip(event, 'fs31', 89)" onmouseover="showTip(event, 'fs31', 89)" class="i">Lookup</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs32', 90)" onmouseover="showTip(event, 'fs32', 90)" class="i">ExactOrSmaller</span>)
<span class="fsi">val it : Frame&lt;DateTimeOffset,string&gt; =</span>
<span class="fsi">                 S2      S3               </span>
<span class="fsi">  12:00:00 AM -&gt; 21.61   21.37 </span>
<span class="fsi">  12:30:00 AM -&gt; 21.64   21.37 </span>
<span class="fsi">   1:00:00 AM -&gt; 21.86   21.37 </span>
<span class="fsi">   1:30:00 AM -&gt; 22.22   22.73 </span>
<span class="fsi">  (...)</span>

<span class="c">// 厳密マッチングでレフトジョインを行うと</span>
<span class="c">// ほとんどが値無しになります</span>
<span onmouseout="hideTip(event, 'fs36', 91)" onmouseover="showTip(event, 'fs36', 91)" class="i">f2</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs38', 92)" onmouseover="showTip(event, 'fs38', 92)" class="i">Join</span>(<span onmouseout="hideTip(event, 'fs37', 93)" onmouseover="showTip(event, 'fs37', 93)" class="i">f3</span>, <span onmouseout="hideTip(event, 'fs28', 94)" onmouseover="showTip(event, 'fs28', 94)" class="i">JoinKind</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs29', 95)" onmouseover="showTip(event, 'fs29', 95)" class="i">Left</span>, <span onmouseout="hideTip(event, 'fs31', 96)" onmouseover="showTip(event, 'fs31', 96)" class="i">Lookup</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs41', 97)" onmouseover="showTip(event, 'fs41', 97)" class="i">Exact</span>)
<span class="fsi">val it : Frame&lt;DateTimeOffset,string&gt; =</span>
<span class="fsi">                 S2      S3               </span>
<span class="fsi">  12:00:00 AM -&gt; 21.61   21.37</span>
<span class="fsi">  12:30:00 AM -&gt; 21.64   &lt;missing&gt;        </span>
<span class="fsi">   1:00:00 AM -&gt; 21.86   &lt;missing&gt;        </span>
<span class="fsi">  (...)</span>

<span class="c">// 関数シンタックスで2行目と同じことを行います</span>
<span onmouseout="hideTip(event, 'fs34', 98)" onmouseover="showTip(event, 'fs34', 98)" class="i">Frame</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs42', 99)" onmouseover="showTip(event, 'fs42', 99)" class="i">join</span> <span onmouseout="hideTip(event, 'fs28', 100)" onmouseover="showTip(event, 'fs28', 100)" class="i">JoinKind</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs39', 101)" onmouseover="showTip(event, 'fs39', 101)" class="i">Outer</span> <span onmouseout="hideTip(event, 'fs33', 102)" onmouseover="showTip(event, 'fs33', 102)" class="i">f1</span> <span onmouseout="hideTip(event, 'fs36', 103)" onmouseover="showTip(event, 'fs36', 103)" class="i">f2</span>

<span class="c">// 関数シンタックスで20行目と同じことを行います</span>
<span onmouseout="hideTip(event, 'fs34', 104)" onmouseover="showTip(event, 'fs34', 104)" class="i">Frame</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs43', 105)" onmouseover="showTip(event, 'fs43', 105)" class="i">joinAlign</span> <span onmouseout="hideTip(event, 'fs28', 106)" onmouseover="showTip(event, 'fs28', 106)" class="i">JoinKind</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs29', 107)" onmouseover="showTip(event, 'fs29', 107)" class="i">Left</span> <span onmouseout="hideTip(event, 'fs31', 108)" onmouseover="showTip(event, 'fs31', 108)" class="i">Lookup</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs32', 109)" onmouseover="showTip(event, 'fs32', 109)" class="i">ExactOrSmaller</span> <span onmouseout="hideTip(event, 'fs33', 110)" onmouseover="showTip(event, 'fs33', 110)" class="i">f1</span> <span onmouseout="hideTip(event, 'fs36', 111)" onmouseover="showTip(event, 'fs36', 111)" class="i">f2</span></pre>
</td>
</tr>
</table>

<p>それぞれの観測値間で異なるオフセットを持った複数のデータシリーズを扱う場合、
自動アライメントの機能はきわめて便利なものです。
キーのセット(日付)を選択するだけで、簡単にキーと一致する
別のデータを整列させることができます。
<code>Join</code> を明示的に使用しない方法としては、
(<code>Frame.ofRowKeys</code> を使用して)対象とするキーを持った新しいフレームを作成し、
<code>AddSeries</code> メンバー(または <code>df?New &lt;- s</code> のシンタックス)を使用して
シリーズを追加することもできます。
この場合には新しいシリーズに対して、現在の行キーに一致するよう自動的に
レフトジョインが行われます。</p>

<p>データをアラインする際、値無しを含んだデータフレームを作成したい、
あるいは作成したくないことがあります。
観測値が厳密な時刻を持たない場合、ミスマッチを防ぐには
<code>Lookup.ExactOrSmaller</code> または <code>Lookup.ExactOrGreater</code> を使用するとよいでしょう。</p>

<p>観測値がたとえばたまたま倍の頻度(1つは1時間毎、もう1つは30分毎)
になっているのであれば、(デフォルト値である) <code>Lookup.Exact</code> を使用すると
値無しを含むデータフレームを作成でき、
(<a href="frame.html#missing">こちらで説明しているように</a>)
明示的に値無しを処理することができます。</p>

<a name="windowing"></a>

<h2>ウィンドウ化、チャンク化、ペア化</h2>

<p>ウィンドウ化とチャンク化は順序付きシリーズの値をグループとして集計する操作です。
これらの操作は順序を考慮しない <a href="tutorial.html#grouping">グループ化</a> とは異なり、
連続する要素を対象とするものです。</p>

<h3>ウィンドウのスライディング</h3>

<p>スライディングウィンドウは特定の大きさのウィンドウ(あるいは特定の条件)を作成します。
ウィンドウは入力シリーズ全体を「スライド」していき、シリーズの一部分を返します。
一般的には複数のウィンドウ内に単一の要素しか現れないという点が重要です。</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
<span class="l">8: </span>
<span class="l">9: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// 6個の観測値を含む入力用シリーズを作成します</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs44', 112)" onmouseover="showTip(event, 'fs44', 112)" class="i">lf</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs24', 113)" onmouseover="showTip(event, 'fs24', 113)" class="i">series</span> <span class="o">&lt;|</span> <span onmouseout="hideTip(event, 'fs17', 114)" onmouseover="showTip(event, 'fs17', 114)" class="i">stock1</span> (<span onmouseout="hideTip(event, 'fs21', 115)" onmouseover="showTip(event, 'fs21', 115)" class="i">TimeSpan</span>(<span class="n">0</span>, <span class="n">1</span>, <span class="n">0</span>)) <span class="n">6</span>

<span class="c">// 各ウィンドウを表すシリーズのシリーズを作成します</span>
<span onmouseout="hideTip(event, 'fs44', 116)" onmouseover="showTip(event, 'fs44', 116)" class="i">lf</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs45', 117)" onmouseover="showTip(event, 'fs45', 117)" class="i">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs46', 118)" onmouseover="showTip(event, 'fs46', 118)" class="i">window</span> <span class="n">4</span>
<span class="c">// &#39;Stats.mean&#39;を使用して各ウィンドウを集計します</span>
<span onmouseout="hideTip(event, 'fs44', 119)" onmouseover="showTip(event, 'fs44', 119)" class="i">lf</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs45', 120)" onmouseover="showTip(event, 'fs45', 120)" class="i">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs47', 121)" onmouseover="showTip(event, 'fs47', 121)" class="i">windowInto</span> <span class="n">4</span> <span onmouseout="hideTip(event, 'fs48', 122)" onmouseover="showTip(event, 'fs48', 122)" class="i">Stats</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs49', 123)" onmouseover="showTip(event, 'fs49', 123)" class="i">mean</span>
<span class="c">// 各ウィンドウの最初の値を取得します</span>
<span onmouseout="hideTip(event, 'fs44', 124)" onmouseover="showTip(event, 'fs44', 124)" class="i">lf</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs45', 125)" onmouseover="showTip(event, 'fs45', 125)" class="i">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs47', 126)" onmouseover="showTip(event, 'fs47', 126)" class="i">windowInto</span> <span class="n">4</span> <span onmouseout="hideTip(event, 'fs45', 127)" onmouseover="showTip(event, 'fs45', 127)" class="i">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs50', 128)" onmouseover="showTip(event, 'fs50', 128)" class="i">firstValue</span></pre>
</td>
</tr>
</table>

<p>上のコードで使用している関数は左から右に移動する、
サイズが4のウィンドウを作成しています。
つまり入力値が <code>[1,2,3,4,5,6]</code> とすると、
<code>[1,2,3,4]</code> <code>[2,3,4,5]</code> <code>[3,4,5,6]</code>
という3つのウィンドウが生成されることになります。
デフォルトでは <code>Series.window</code> 関数はウィンドウの最後の要素のキーを
ウィンドウ全体のキーとして選択します
(この挙動を変更する方法についてはもう少し後で説明します)：</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// スライディングウィンドウの平均を計算します</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs51', 129)" onmouseover="showTip(event, 'fs51', 129)" class="i">lfm1</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs44', 130)" onmouseover="showTip(event, 'fs44', 130)" class="i">lf</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs45', 131)" onmouseover="showTip(event, 'fs45', 131)" class="i">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs47', 132)" onmouseover="showTip(event, 'fs47', 132)" class="i">windowInto</span> <span class="n">4</span> <span onmouseout="hideTip(event, 'fs48', 133)" onmouseover="showTip(event, 'fs48', 133)" class="i">Stats</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs49', 134)" onmouseover="showTip(event, 'fs49', 134)" class="i">mean</span>
<span class="c">// アラインされた結果を表示するためのデータフレームを作成します</span>
<span onmouseout="hideTip(event, 'fs34', 135)" onmouseover="showTip(event, 'fs34', 135)" class="i">Frame</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs35', 136)" onmouseover="showTip(event, 'fs35', 136)" class="i">ofColumns</span> [ <span class="s">&quot;</span><span class="s">Orig</span><span class="s">&quot;</span> <span class="o">=&gt;</span> <span onmouseout="hideTip(event, 'fs44', 137)" onmouseover="showTip(event, 'fs44', 137)" class="i">lf</span>; <span class="s">&quot;</span><span class="s">Means</span><span class="s">&quot;</span> <span class="o">=&gt;</span> <span onmouseout="hideTip(event, 'fs51', 138)" onmouseover="showTip(event, 'fs51', 138)" class="i">lfm1</span> ]
<span class="fsi">val it : Frame&lt;DateTimeOffset,string&gt; =</span>
<span class="fsi">                 Means      Orig </span>
<span class="fsi">  12:00:00 AM -&gt; &lt;missing&gt;  20.16</span>
<span class="fsi">  12:01:00 AM -&gt; &lt;missing&gt;  20.32</span>
<span class="fsi">  12:02:00 AM -&gt; &lt;missing&gt;  20.25</span>
<span class="fsi">  12:03:00 AM -&gt; 20.30      20.45</span>
<span class="fsi">  12:04:00 AM -&gt; 20.34      20.32</span>
<span class="fsi">  12:05:00 AM -&gt; 20.34      20.33</span></pre>
</td>
</tr>
</table>

<p><code>&lt;missing&gt;</code> の値が出来てしまうのを避けたい場合にはどうしたらよいでしょうか？
1つのアプローチとしては開始時刻の先頭または末尾で小さなサイズのウィンドウを
生成するようにします。
この場合、 <code>[1]</code> <code>[1,2]</code> <code>[1,2,3]</code> という<strong>不完全な</strong>ウィンドウに続けて、
上の結果にある3つの<strong>完全な</strong>ウィンドウが生成されることになります：</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs52', 139)" onmouseover="showTip(event, 'fs52', 139)" class="i">lfm2</span> <span class="o">=</span> 
  <span class="c">// 先頭では不完全なサイズのスライディングウィンドウを作成します</span>
  <span onmouseout="hideTip(event, 'fs44', 140)" onmouseover="showTip(event, 'fs44', 140)" class="i">lf</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs45', 141)" onmouseover="showTip(event, 'fs45', 141)" class="i">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs53', 142)" onmouseover="showTip(event, 'fs53', 142)" class="i">windowSizeInto</span> (<span class="n">4</span>, <span onmouseout="hideTip(event, 'fs54', 143)" onmouseover="showTip(event, 'fs54', 143)" class="i">Boundary</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs55', 144)" onmouseover="showTip(event, 'fs55', 144)" class="i">AtBeginning</span>) (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs56', 145)" onmouseover="showTip(event, 'fs56', 145)" class="i">ds</span> <span class="k">-&gt;</span>
    <span onmouseout="hideTip(event, 'fs48', 146)" onmouseover="showTip(event, 'fs48', 146)" class="i">Stats</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs49', 147)" onmouseover="showTip(event, 'fs49', 147)" class="i">mean</span> <span onmouseout="hideTip(event, 'fs56', 148)" onmouseover="showTip(event, 'fs56', 148)" class="i">ds</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs57', 149)" onmouseover="showTip(event, 'fs57', 149)" class="i">Data</span>)

<span onmouseout="hideTip(event, 'fs34', 150)" onmouseover="showTip(event, 'fs34', 150)" class="i">Frame</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs35', 151)" onmouseover="showTip(event, 'fs35', 151)" class="i">ofColumns</span> [ <span class="s">&quot;</span><span class="s">Orig</span><span class="s">&quot;</span> <span class="o">=&gt;</span> <span onmouseout="hideTip(event, 'fs44', 152)" onmouseover="showTip(event, 'fs44', 152)" class="i">lf</span>; <span class="s">&quot;</span><span class="s">Means</span><span class="s">&quot;</span> <span class="o">=&gt;</span> <span onmouseout="hideTip(event, 'fs52', 153)" onmouseover="showTip(event, 'fs52', 153)" class="i">lfm2</span> ]
<span class="fsi">val it : Frame&lt;DateTimeOffset,string&gt; =</span>
<span class="fsi">                 Means  Orig </span>
<span class="fsi">  12:00:00 AM -&gt; 20.16  20.16</span>
<span class="fsi">  12:01:00 AM -&gt; 20.24  20.32</span>
<span class="fsi">  12:02:00 AM -&gt; 20.24  20.25</span>
<span class="fsi">  12:03:00 AM -&gt; 20.30  20.45</span>
<span class="fsi">  12:04:00 AM -&gt; 20.34  20.32</span>
<span class="fsi">  12:05:00 AM -&gt; 20.34  20.33</span></pre>
</td>
</tr>
</table>

<p>見ての通り、1行目では1つしかデータが無いシリーズの
<code>Mean</code> (平均)を計算しているわけなので、
いずれも同じ値になっています。</p>

<p>(今回の例のように) <code>Boundary.AtBeginning</code> や
(1つ前の例で使用している、デフォルト値) <code>Boundary.Skip</code> を指定すると、
この関数はウィンドウの最後のキーを集計値のキーとして
使用するようになります。
また、 <code>Boundary.AtEnding</code> を指定すると最初のキーが使用されるため、
オリジナルの値をいい感じにアラインすることができます。
独自のキーセレクター指定したい場合には、さらに汎用的な関数
<code>Series.aggregate</code> を使用します。</p>

<p>この例では、集計を行うコードが <code>Stats.mean</code> のような単なる関数ではなく、
<code>DataSegment&lt;T&gt;</code> 型の引数 <code>ds</code> をとるラムダ式になっています。
この型にはウィンドウが完全かどうかを示す情報が含まれています。
たとえば以下のようにできます：</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// 文字を含んだ単純なシリーズ</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs58', 154)" onmouseover="showTip(event, 'fs58', 154)" class="i">st</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs45', 155)" onmouseover="showTip(event, 'fs45', 155)" class="i">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs59', 156)" onmouseover="showTip(event, 'fs59', 156)" class="i">ofValues</span> [ <span class="s">&#39;a&#39;</span> <span class="o">..</span> <span class="s">&#39;e&#39;</span> ]
<span onmouseout="hideTip(event, 'fs58', 157)" onmouseover="showTip(event, 'fs58', 157)" class="i">st</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs45', 158)" onmouseover="showTip(event, 'fs45', 158)" class="i">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs53', 159)" onmouseover="showTip(event, 'fs53', 159)" class="i">windowSizeInto</span> (<span class="n">3</span>, <span onmouseout="hideTip(event, 'fs54', 160)" onmouseover="showTip(event, 'fs54', 160)" class="i">Boundary</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs60', 161)" onmouseover="showTip(event, 'fs60', 161)" class="i">AtEnding</span>) (<span class="k">function</span>
  | <span onmouseout="hideTip(event, 'fs61', 162)" onmouseover="showTip(event, 'fs61', 162)" class="i">DataSegment</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs62', 163)" onmouseover="showTip(event, 'fs62', 163)" class="i">Complete</span>(<span onmouseout="hideTip(event, 'fs63', 164)" onmouseover="showTip(event, 'fs63', 164)" class="i">ser</span>) <span class="k">-&gt;</span> 
      <span class="c">// 完全なウィンドウに対しては大文字の文字列を返す</span>
      <span onmouseout="hideTip(event, 'fs64', 165)" onmouseover="showTip(event, 'fs64', 165)" class="i">String</span>(<span onmouseout="hideTip(event, 'fs63', 166)" onmouseover="showTip(event, 'fs63', 166)" class="i">ser</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs45', 167)" onmouseover="showTip(event, 'fs45', 167)" class="i">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs65', 168)" onmouseover="showTip(event, 'fs65', 168)" class="i">values</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs66', 169)" onmouseover="showTip(event, 'fs66', 169)" class="i">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs67', 170)" onmouseover="showTip(event, 'fs67', 170)" class="i">ofSeq</span>)<span class="o">.</span><span class="i">ToUpper</span>()
  | <span onmouseout="hideTip(event, 'fs61', 171)" onmouseover="showTip(event, 'fs61', 171)" class="i">DataSegment</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs68', 172)" onmouseover="showTip(event, 'fs68', 172)" class="i">Incomplete</span>(<span onmouseout="hideTip(event, 'fs63', 173)" onmouseover="showTip(event, 'fs63', 173)" class="i">ser</span>) <span class="k">-&gt;</span> 
      <span class="c">// 不完全なウィンドウに対しては小文字かつ字詰めした文字列を返す</span>
      <span onmouseout="hideTip(event, 'fs64', 174)" onmouseover="showTip(event, 'fs64', 174)" class="i">String</span>(<span onmouseout="hideTip(event, 'fs63', 175)" onmouseover="showTip(event, 'fs63', 175)" class="i">ser</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs45', 176)" onmouseover="showTip(event, 'fs45', 176)" class="i">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs65', 177)" onmouseover="showTip(event, 'fs65', 177)" class="i">values</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs66', 178)" onmouseover="showTip(event, 'fs66', 178)" class="i">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs67', 179)" onmouseover="showTip(event, 'fs67', 179)" class="i">ofSeq</span>)<span class="o">.</span><span class="i">PadRight</span>(<span class="n">3</span>, <span class="s">&#39;-&#39;</span>) )  
<span class="fsi">val it : Series&lt;int,string&gt; =</span>
<span class="fsi">  0 -&gt; ABC </span>
<span class="fsi">  1 -&gt; BCD </span>
<span class="fsi">  2 -&gt; CDE </span>
<span class="fsi">  3 -&gt; de- </span>
<span class="fsi">  4 -&gt; e-- </span></pre>
</td>
</tr>
</table>

<h3>ウィンドウのサイズ条件</h3>

<p>先の例では固定サイズのウィンドウを生成しました。
しかしウィンドウの終点を指定する方法としてはさらに2つのオプションがあります。</p>

<ul>
<li>1つ目のオプションは始点キーと終点キーの最大<strong>距離</strong>を指定する方法です</li>
<li>2つ目のオプションは始点キーと終点キーで呼び出される関数を指定する方法です。
この関数は終点に至るとfalseを返します。</li>
</ul>

<p>これらはそれぞれ <code>Series.windowDist</code> と <code>Series. windowWhile</code> として
実装されています
(また、各ウィンドウを集計するために呼び出される関数を指定することができる、
<code>Into</code> サフィックスのついたバージョンもあります)：</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// 30日間の価格を1時間単位にまとめます</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs69', 180)" onmouseover="showTip(event, 'fs69', 180)" class="i">hourly</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs24', 181)" onmouseover="showTip(event, 'fs24', 181)" class="i">series</span> <span class="o">&lt;|</span> <span onmouseout="hideTip(event, 'fs17', 182)" onmouseover="showTip(event, 'fs17', 182)" class="i">stock1</span> (<span onmouseout="hideTip(event, 'fs21', 183)" onmouseover="showTip(event, 'fs21', 183)" class="i">TimeSpan</span>(<span class="n">1</span>, <span class="n">0</span>, <span class="n">0</span>)) (<span class="n">30</span><span class="o">*</span><span class="n">24</span>)

<span class="c">// 1日単位のウィンドウを作成します(ソースがイレギュラーなデータを含む場合、</span>
<span class="c">// ウィンドウのサイズはまちまちになります)</span>
<span onmouseout="hideTip(event, 'fs69', 184)" onmouseover="showTip(event, 'fs69', 184)" class="i">hourly</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs45', 185)" onmouseover="showTip(event, 'fs45', 185)" class="i">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs70', 186)" onmouseover="showTip(event, 'fs70', 186)" class="i">windowDist</span> (<span onmouseout="hideTip(event, 'fs21', 187)" onmouseover="showTip(event, 'fs21', 187)" class="i">TimeSpan</span>(<span class="n">24</span>, <span class="n">0</span>, <span class="n">0</span>))

<span class="c">// 同じ日付のデータが同じウィンドウに入るようなウィンドウを生成します</span>
<span class="c">// (各ウィンドウは0時に始まり、同日の最終時刻データまでが含まれます)</span>
<span onmouseout="hideTip(event, 'fs69', 188)" onmouseover="showTip(event, 'fs69', 188)" class="i">hourly</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs45', 189)" onmouseover="showTip(event, 'fs45', 189)" class="i">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs71', 190)" onmouseover="showTip(event, 'fs71', 190)" class="i">windowWhile</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs72', 191)" onmouseover="showTip(event, 'fs72', 191)" class="i">d1</span> <span onmouseout="hideTip(event, 'fs73', 192)" onmouseover="showTip(event, 'fs73', 192)" class="i">d2</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs72', 193)" onmouseover="showTip(event, 'fs72', 193)" class="i">d1</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs74', 194)" onmouseover="showTip(event, 'fs74', 194)" class="i">Date</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs73', 195)" onmouseover="showTip(event, 'fs73', 195)" class="i">d2</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs74', 196)" onmouseover="showTip(event, 'fs74', 196)" class="i">Date</span>)</pre>
</td>
</tr>
</table>

<h3>シリーズのチャンク化</h3>

<p>チャンク化(chunking)はウィンドウ化に似ていますが、
(重複する)スライディングウィンドウとは異なり、
重複部分のないチャンク(訳注：データの小さなかたまり)が生成されます。
チャンクのサイズはスライディングウィンドウの場合と同じく、
3つの方法で指定できます(固定長、キー間の距離および特定条件)：</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// 10分間、1秒単位の観測値を生成します</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs75', 197)" onmouseover="showTip(event, 'fs75', 197)" class="i">hf</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs24', 198)" onmouseover="showTip(event, 'fs24', 198)" class="i">series</span> <span class="o">&lt;|</span> <span onmouseout="hideTip(event, 'fs17', 199)" onmouseover="showTip(event, 'fs17', 199)" class="i">stock1</span> (<span onmouseout="hideTip(event, 'fs21', 200)" onmouseover="showTip(event, 'fs21', 200)" class="i">TimeSpan</span>(<span class="n">0</span>, <span class="n">0</span>, <span class="n">1</span>)) <span class="n">600</span>

<span class="c">// 10秒単位のチャンクを作成して、(おそらくは)末尾では</span>
<span class="c">// 10秒未満のチャンクとなるようにします。</span>
<span onmouseout="hideTip(event, 'fs75', 201)" onmouseover="showTip(event, 'fs75', 201)" class="i">hf</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs45', 202)" onmouseover="showTip(event, 'fs45', 202)" class="i">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs76', 203)" onmouseover="showTip(event, 'fs76', 203)" class="i">chunkSize</span> (<span class="n">10</span>, <span onmouseout="hideTip(event, 'fs54', 204)" onmouseover="showTip(event, 'fs54', 204)" class="i">Boundary</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs60', 205)" onmouseover="showTip(event, 'fs60', 205)" class="i">AtEnding</span>) 

<span class="c">// 10秒間隔でチャンクを作成して、</span>
<span class="c">// 各チャンクにある最初の観測値(ダウンサンプル)を取得します</span>
<span onmouseout="hideTip(event, 'fs75', 206)" onmouseover="showTip(event, 'fs75', 206)" class="i">hf</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs45', 207)" onmouseover="showTip(event, 'fs45', 207)" class="i">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs77', 208)" onmouseover="showTip(event, 'fs77', 208)" class="i">chunkDistInto</span> (<span onmouseout="hideTip(event, 'fs21', 209)" onmouseover="showTip(event, 'fs21', 209)" class="i">TimeSpan</span>(<span class="n">0</span>, <span class="n">0</span>, <span class="n">10</span>)) <span onmouseout="hideTip(event, 'fs45', 210)" onmouseover="showTip(event, 'fs45', 210)" class="i">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs50', 211)" onmouseover="showTip(event, 'fs50', 211)" class="i">firstValue</span>

<span class="c">// hh:mm(時分)の値が同じもの同士でチャンクを作成します</span>
<span class="c">// (すべての秒データがいずれかのチャンクに含まれることになります)</span>
<span onmouseout="hideTip(event, 'fs75', 212)" onmouseover="showTip(event, 'fs75', 212)" class="i">hf</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs45', 213)" onmouseover="showTip(event, 'fs45', 213)" class="i">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs78', 214)" onmouseover="showTip(event, 'fs78', 214)" class="i">chunkWhile</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs79', 215)" onmouseover="showTip(event, 'fs79', 215)" class="i">k1</span> <span onmouseout="hideTip(event, 'fs80', 216)" onmouseover="showTip(event, 'fs80', 216)" class="i">k2</span> <span class="k">-&gt;</span> 
  (<span onmouseout="hideTip(event, 'fs79', 217)" onmouseover="showTip(event, 'fs79', 217)" class="i">k1</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs81', 218)" onmouseover="showTip(event, 'fs81', 218)" class="i">Hour</span>, <span onmouseout="hideTip(event, 'fs79', 219)" onmouseover="showTip(event, 'fs79', 219)" class="i">k1</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs82', 220)" onmouseover="showTip(event, 'fs82', 220)" class="i">Minute</span>) <span class="o">=</span> (<span onmouseout="hideTip(event, 'fs80', 221)" onmouseover="showTip(event, 'fs80', 221)" class="i">k2</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs81', 222)" onmouseover="showTip(event, 'fs81', 222)" class="i">Hour</span>, <span onmouseout="hideTip(event, 'fs80', 223)" onmouseover="showTip(event, 'fs80', 223)" class="i">k2</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs82', 224)" onmouseover="showTip(event, 'fs82', 224)" class="i">Minute</span>))</pre>
</td>
</tr>
</table>

<p>上の例では非常によく似た方法で様々なチャンク化関数を呼び出しています。
これは主に、ランダムに生成された入力データが非常に均一だというのが理由です。
しかし均一ではないキーを持った入力に対しては、
上のそれぞれの関数は異なった動作になります。</p>

<p><code>chunkSize</code> を使用する場合、チャンクのサイズは同じになりますが、
時間の間隔が異なるシリーズに対応する場合があります。
<code>chunkDist</code> ではそれぞれのチャンクにおける最大の時刻が存在することが保証されますが、
いつチャンクが開始されるのかは保証されません。
これは <code>chunkWhile</code> を使用した場合も同様です。</p>

<p>最後に、これまで紹介した集計関数はいずれも <code>Series.aggregate</code>
の特化版であることを明記しておきます。
この関数には集計の種類を判別共用体で指定できます。
(<a href="../reference/fsharp-dataframe-aggregation-1.html">APIリファレンスを参照してください</a>)
しかし実際のところはここで紹介したヘルパー関数を使用した方が簡単です。
一部のまれなケースにおいては、 <code>Series.aggregate</code> にいくつかオプションを指定して
呼び出す必要があるかもしれません。</p>

<h3>ペア化</h3>

<p>ウィンドウ化の特別版として、入力されたシリーズから現在および直前の値を含んだ
一連のペアを生成することができます
(別の言い方をすると、各ペアのキーがペアの後者であるようなウィンドウということです)。
たとえば以下のようにします：</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// 前述の &#39;hf&#39; から一連のペアを生成します</span>
<span onmouseout="hideTip(event, 'fs75', 225)" onmouseover="showTip(event, 'fs75', 225)" class="i">hf</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs45', 226)" onmouseover="showTip(event, 'fs45', 226)" class="i">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs83', 227)" onmouseover="showTip(event, 'fs83', 227)" class="i">pairwise</span> 

<span class="c">// 現在の値と直前の値の差を計算します</span>
<span onmouseout="hideTip(event, 'fs75', 228)" onmouseover="showTip(event, 'fs75', 228)" class="i">hf</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs45', 229)" onmouseover="showTip(event, 'fs45', 229)" class="i">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs84', 230)" onmouseover="showTip(event, 'fs84', 230)" class="i">pairwiseWith</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs85', 231)" onmouseover="showTip(event, 'fs85', 231)" class="i">k</span> (<span onmouseout="hideTip(event, 'fs86', 232)" onmouseover="showTip(event, 'fs86', 232)" class="i">v1</span>, <span onmouseout="hideTip(event, 'fs87', 233)" onmouseover="showTip(event, 'fs87', 233)" class="i">v2</span>) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs87', 234)" onmouseover="showTip(event, 'fs87', 234)" class="i">v2</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs86', 235)" onmouseover="showTip(event, 'fs86', 235)" class="i">v1</span>)</pre>
</td>
</tr>
</table>

<p><code>pairwise</code> 演算では、入力されたシリーズの最初の値をキーとする値を
含まないようなシリーズが常に返されます。
さらに複雑な動作をさせる必要がある場合には、
<code>pairwise</code> を <code>window</code> に置き換えることになります。
たとえば最初の要素としてシリーズの最初の値を含み、
以降にはペアの差分を含むようなシリーズを取得したいとします。
このシリーズには、最初の値から行を加算していくと
それぞれの時点における価格が計算できるという素敵な性質があります：</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// 一番最初は不完全なセグメントとなるスライディングウィンドウ</span>
<span onmouseout="hideTip(event, 'fs75', 236)" onmouseover="showTip(event, 'fs75', 236)" class="i">hf</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs45', 237)" onmouseover="showTip(event, 'fs45', 237)" class="i">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs53', 238)" onmouseover="showTip(event, 'fs53', 238)" class="i">windowSizeInto</span> (<span class="n">2</span>, <span onmouseout="hideTip(event, 'fs54', 239)" onmouseover="showTip(event, 'fs54', 239)" class="i">Boundary</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs55', 240)" onmouseover="showTip(event, 'fs55', 240)" class="i">AtBeginning</span>) (<span class="k">function</span>
  <span class="c">// 1番目のセグメントに対しては1つめの値を返す</span>
  | <span onmouseout="hideTip(event, 'fs61', 241)" onmouseover="showTip(event, 'fs61', 241)" class="i">DataSegment</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs68', 242)" onmouseover="showTip(event, 'fs68', 242)" class="i">Incomplete</span> <span onmouseout="hideTip(event, 'fs88', 243)" onmouseover="showTip(event, 'fs88', 243)" class="i">s</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs88', 244)" onmouseover="showTip(event, 'fs88', 244)" class="i">s</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs89', 245)" onmouseover="showTip(event, 'fs89', 245)" class="i">GetAt</span>(<span class="n">0</span>)
  <span class="c">// その他のセグメントに対しては差分を計算する</span>
  | <span onmouseout="hideTip(event, 'fs61', 246)" onmouseover="showTip(event, 'fs61', 246)" class="i">DataSegment</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs62', 247)" onmouseover="showTip(event, 'fs62', 247)" class="i">Complete</span> <span onmouseout="hideTip(event, 'fs88', 248)" onmouseover="showTip(event, 'fs88', 248)" class="i">s</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs88', 249)" onmouseover="showTip(event, 'fs88', 249)" class="i">s</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs89', 250)" onmouseover="showTip(event, 'fs89', 250)" class="i">GetAt</span>(<span class="n">1</span>) <span class="o">-</span> <span onmouseout="hideTip(event, 'fs88', 251)" onmouseover="showTip(event, 'fs88', 251)" class="i">s</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs89', 252)" onmouseover="showTip(event, 'fs89', 252)" class="i">GetAt</span>(<span class="n">0</span>))</pre>
</td>
</tr>
</table>

<a name="sampling"></a>

<h2>時系列データのサンプリングおよび再サンプリング</h2>

<p>高頻度の価格データを持った時系列データに対して、
サンプリングあるいは再サンプリングを行うと頻度の低い値を含んだ
時系列データを取得することができます。
このライブラリでは以下の用語を使用します：</p>

<ul>
<li><p><strong>ルックアップ(Lookup)</strong> とは、
特定のキーに対する値を検索することを表します。
なおキーが利用できない場合、指定した値に最も近く、それよりも小さいか大きい値を
見つけることもできます。</p></li>
<li><p><strong>再サンプリング(Resampling)</strong> とは、
特定のキーコレクション(たとえば明示的に指定した時刻)、
あるいはキー同士の関係性(たとえば日付が同じ時刻)
を元にして値を集計することを表します。</p></li>
<li><p><strong>ユニフォーム再サンプリング(Uniform resampling)</strong> は
再サンプリングと似ていますが、一意なキーのシーケンス(たとえば日付)を生成する
関数によってキーを指定します。
またこの関数では、キーに対応する値が入力シーケンス中に見つからなかった場合に
値を埋めさせることもできます。</p></li>
</ul>

<p>なおこのライブラリにはキーの型が <code>DateTime</code> あるいは <code>DateTimeOffset</code> の
シリーズデータに特化したヘルパー関数がいくつか用意されています。</p>

<h3>ルックアップ</h3>

<p>シリーズ <code>hf</code> に対して、 <code>hf.Get(key)</code> または <code>hf |&gt; SEries.get key</code> とすると
特定のキーに対する1つの値が取得できます。
しかし複数のキーに対する複数の値を同時に取得することも可能です。
そのためのインスタンスメンバーが <code>hf.GetItems(..)</code> です。
また、 <code>Get</code> および <code>GetItems</code> にはオプションとして
キーに厳密に一致する値が見つからなかった場合の挙動を指定することもできます。</p>

<p>関数シンタックスを使用する場合、厳密なキールックアップを
行う場合には <code>Series.getAll</code>、より柔軟なルックアップを行いたい場合には
<code>Series.lookupAll</code> を使用します：</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// 13.7秒間隔で24時間以内のデータを生成します</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs90', 253)" onmouseover="showTip(event, 'fs90', 253)" class="i">mf</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs24', 254)" onmouseover="showTip(event, 'fs24', 254)" class="i">series</span> <span class="o">&lt;|</span> <span onmouseout="hideTip(event, 'fs17', 255)" onmouseover="showTip(event, 'fs17', 255)" class="i">stock1</span> (<span onmouseout="hideTip(event, 'fs21', 256)" onmouseover="showTip(event, 'fs21', 256)" class="i">TimeSpan</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs91', 257)" onmouseover="showTip(event, 'fs91', 257)" class="i">FromSeconds</span>(<span class="n">13.7</span>)) <span class="n">6300</span>
<span class="c">// 1分間隔で24時間以内のキーを生成します</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs92', 258)" onmouseover="showTip(event, 'fs92', 258)" class="i">keys</span> <span class="o">=</span> [ <span class="k">for</span> <span onmouseout="hideTip(event, 'fs93', 259)" onmouseover="showTip(event, 'fs93', 259)" class="i">m</span> <span class="k">in</span> <span class="n">0.0</span> <span class="o">..</span> <span class="n">24.0</span><span class="o">*</span><span class="n">60.0</span><span class="o">-</span><span class="n">1.0</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs13', 260)" onmouseover="showTip(event, 'fs13', 260)" class="i">today</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs94', 261)" onmouseover="showTip(event, 'fs94', 261)" class="i">AddMinutes</span>(<span onmouseout="hideTip(event, 'fs93', 262)" onmouseover="showTip(event, 'fs93', 262)" class="i">m</span>) ]

<span class="c">// 特定のキーに一致する値、または最も近く大きい値を検索します</span>
<span onmouseout="hideTip(event, 'fs90', 263)" onmouseover="showTip(event, 'fs90', 263)" class="i">mf</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs45', 264)" onmouseover="showTip(event, 'fs45', 264)" class="i">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs95', 265)" onmouseover="showTip(event, 'fs95', 265)" class="i">lookupAll</span> <span onmouseout="hideTip(event, 'fs92', 266)" onmouseover="showTip(event, 'fs92', 266)" class="i">keys</span> <span onmouseout="hideTip(event, 'fs31', 267)" onmouseover="showTip(event, 'fs31', 267)" class="i">Lookup</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs96', 268)" onmouseover="showTip(event, 'fs96', 268)" class="i">ExactOrGreater</span>
<span class="fsi">val it : Series&lt;DateTimeOffset,float&gt; =</span>
<span class="fsi">  12:00:00 AM -&gt; 20.07 </span>
<span class="fsi">  12:01:00 AM -&gt; 19.98 </span>
<span class="fsi">  ...         -&gt; ...   </span>
<span class="fsi">  11:58:00 PM -&gt; 19.03 </span>
<span class="fsi">  11:59:00 PM -&gt; &lt;missing&gt;        </span>

<span class="c">// 最も近く小さいキーに対する値を検索します</span>
<span class="c">// (この場合には午後11:59:00の値が返されます)</span>
<span onmouseout="hideTip(event, 'fs90', 269)" onmouseover="showTip(event, 'fs90', 269)" class="i">mf</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs45', 270)" onmouseover="showTip(event, 'fs45', 270)" class="i">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs95', 271)" onmouseover="showTip(event, 'fs95', 271)" class="i">lookupAll</span> <span onmouseout="hideTip(event, 'fs92', 272)" onmouseover="showTip(event, 'fs92', 272)" class="i">keys</span> <span onmouseout="hideTip(event, 'fs31', 273)" onmouseover="showTip(event, 'fs31', 273)" class="i">Lookup</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs32', 274)" onmouseover="showTip(event, 'fs32', 274)" class="i">ExactOrSmaller</span>

<span class="c">// キーに厳密に一致する値を検索します</span>
<span class="c">// (1番目のキーに対してのみ機能します)</span>
<span onmouseout="hideTip(event, 'fs90', 275)" onmouseover="showTip(event, 'fs90', 275)" class="i">mf</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs45', 276)" onmouseover="showTip(event, 'fs45', 276)" class="i">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs95', 277)" onmouseover="showTip(event, 'fs95', 277)" class="i">lookupAll</span> <span onmouseout="hideTip(event, 'fs92', 278)" onmouseover="showTip(event, 'fs92', 278)" class="i">keys</span> <span onmouseout="hideTip(event, 'fs31', 279)" onmouseover="showTip(event, 'fs31', 279)" class="i">Lookup</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs41', 280)" onmouseover="showTip(event, 'fs41', 280)" class="i">Exact</span></pre>
</td>
</tr>
</table>

<p>ルックアップ操作ではキーそれぞれに対して1つの値しか返されません。
そのため巨大な(あるいは高頻度の)データから
簡単にサンプリングする場合に便利なものです。
複数の値を元にして新しい値を計算したい場合には
再サンプリングする必要があります。</p>

<h3>再サンプリング</h3>

<p>シリーズでは2種類の再サンプリングがサポートされています。
1つめは明示的にキーを指定しなければならないルックアップとよく似ています。
違いとして、再サンプリングでは直近のキーだけではなく、
すべてのより小さなキー、あるいはより大きなキーが見つかります。
たとえば以下のようになります：</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// 各キーに対して、大きいキーまでにある値を取得します</span>
<span class="c">// (午後11:59:00のチャンクは空になります)</span>
<span onmouseout="hideTip(event, 'fs90', 281)" onmouseover="showTip(event, 'fs90', 281)" class="i">mf</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs45', 282)" onmouseover="showTip(event, 'fs45', 282)" class="i">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs97', 283)" onmouseover="showTip(event, 'fs97', 283)" class="i">resample</span> <span onmouseout="hideTip(event, 'fs92', 284)" onmouseover="showTip(event, 'fs92', 284)" class="i">keys</span> <span onmouseout="hideTip(event, 'fs98', 285)" onmouseover="showTip(event, 'fs98', 285)" class="i">Direction</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs99', 286)" onmouseover="showTip(event, 'fs99', 286)" class="i">Forward</span>

<span class="c">// 各キーに対して、小さいキーまでにある値を取得します</span>
<span class="c">// (最初のチャンクにはシリーズ1つだけが含まれます)</span>
<span onmouseout="hideTip(event, 'fs90', 287)" onmouseover="showTip(event, 'fs90', 287)" class="i">mf</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs45', 288)" onmouseover="showTip(event, 'fs45', 288)" class="i">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs97', 289)" onmouseover="showTip(event, 'fs97', 289)" class="i">resample</span> <span onmouseout="hideTip(event, 'fs92', 290)" onmouseover="showTip(event, 'fs92', 290)" class="i">keys</span> <span onmouseout="hideTip(event, 'fs98', 291)" onmouseover="showTip(event, 'fs98', 291)" class="i">Direction</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs100', 292)" onmouseover="showTip(event, 'fs100', 292)" class="i">Backward</span>

<span class="c">// チャンク内にある一連の値の平均を集計します</span>
<span onmouseout="hideTip(event, 'fs90', 293)" onmouseover="showTip(event, 'fs90', 293)" class="i">mf</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs45', 294)" onmouseover="showTip(event, 'fs45', 294)" class="i">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs101', 295)" onmouseover="showTip(event, 'fs101', 295)" class="i">resampleInto</span> <span onmouseout="hideTip(event, 'fs92', 296)" onmouseover="showTip(event, 'fs92', 296)" class="i">keys</span> <span onmouseout="hideTip(event, 'fs98', 297)" onmouseover="showTip(event, 'fs98', 297)" class="i">Direction</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs100', 298)" onmouseover="showTip(event, 'fs100', 298)" class="i">Backward</span> 
  (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs85', 299)" onmouseover="showTip(event, 'fs85', 299)" class="i">k</span> <span onmouseout="hideTip(event, 'fs88', 300)" onmouseover="showTip(event, 'fs88', 300)" class="i">s</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs48', 301)" onmouseover="showTip(event, 'fs48', 301)" class="i">Stats</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs49', 302)" onmouseover="showTip(event, 'fs49', 302)" class="i">mean</span> <span onmouseout="hideTip(event, 'fs88', 303)" onmouseover="showTip(event, 'fs88', 303)" class="i">s</span>)

<span class="c">// 再サンプリングはメンバ構文でも実行できます</span>
<span onmouseout="hideTip(event, 'fs90', 304)" onmouseover="showTip(event, 'fs90', 304)" class="i">mf</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs102', 305)" onmouseover="showTip(event, 'fs102', 305)" class="i">Resample</span>(<span onmouseout="hideTip(event, 'fs92', 306)" onmouseover="showTip(event, 'fs92', 306)" class="i">keys</span>, <span onmouseout="hideTip(event, 'fs98', 307)" onmouseover="showTip(event, 'fs98', 307)" class="i">Direction</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs99', 308)" onmouseover="showTip(event, 'fs99', 308)" class="i">Forward</span>)</pre>
</td>
</tr>
</table>

<p>2つめの方法として、シリーズ内にある既存のキーに対する射影を元にして
再サンプリングすることもできます。
この操作では、射影によって同じキーが返されるようなチャンクを収集します。
この動作は <code>Series.groupBy</code> と非常によく似ていますが、
再サンプリングでは射影によってキーの順序が維持されることが想定されます。
そのため、連続するキーだけが集計されます。</p>

<p>一般的なシナリオとしては、時刻情報(今回の場合は<code>DateTimeOffset</code>)を含んだ
時系列データがあり、日単位の情報を取得したい場合が想定できます
(ここでは日付を表すために、時刻データが空の <code>DateTime</code> を使用します)：</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
<span class="l">8: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// 1.7時間毎、2.5ヶ月分のデータを生成します</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs103', 309)" onmouseover="showTip(event, 'fs103', 309)" class="i">ds</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs24', 310)" onmouseover="showTip(event, 'fs24', 310)" class="i">series</span> <span class="o">&lt;|</span> <span onmouseout="hideTip(event, 'fs17', 311)" onmouseover="showTip(event, 'fs17', 311)" class="i">stock1</span> (<span onmouseout="hideTip(event, 'fs21', 312)" onmouseover="showTip(event, 'fs21', 312)" class="i">TimeSpan</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs104', 313)" onmouseover="showTip(event, 'fs104', 313)" class="i">FromHours</span>(<span class="n">1.7</span>)) <span class="n">1000</span>

<span class="c">// (&#39;DateTime&#39;型の)日単位でサンプリング</span>
<span onmouseout="hideTip(event, 'fs103', 314)" onmouseover="showTip(event, 'fs103', 314)" class="i">ds</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs45', 315)" onmouseover="showTip(event, 'fs45', 315)" class="i">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs105', 316)" onmouseover="showTip(event, 'fs105', 316)" class="i">resampleEquiv</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs106', 317)" onmouseover="showTip(event, 'fs106', 317)" class="i">d</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs106', 318)" onmouseover="showTip(event, 'fs106', 318)" class="i">d</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs74', 319)" onmouseover="showTip(event, 'fs74', 319)" class="i">Date</span>)

<span class="c">// (&#39;DateTime&#39;型の)日単位でサンプリング</span>
<span onmouseout="hideTip(event, 'fs103', 320)" onmouseover="showTip(event, 'fs103', 320)" class="i">ds</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs107', 321)" onmouseover="showTip(event, 'fs107', 321)" class="i">ResampleEquivalence</span>(<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs106', 322)" onmouseover="showTip(event, 'fs106', 322)" class="i">d</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs106', 323)" onmouseover="showTip(event, 'fs106', 323)" class="i">d</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs74', 324)" onmouseover="showTip(event, 'fs74', 324)" class="i">Date</span>)</pre>
</td>
</tr>
</table>

<p>同じ処理は <code>Series.chunkWhile</code> を使用して簡単に実装できますが、
サンプリングという文脈で使用されることが多いことも有り、
ライブラリに標準実装してあります。
さらに、ユニフォーム再サンプリングと密接な関係があることを後ほど説明します。</p>

<p>なお結果として返されるシリーズは元とは異なる型のキーを持つことに注意してください。
元データでは(時刻を含む日付を表す) <code>DateTimeOffset</code> 型のキーでしたが、
結果のキーは射影によって返される型になります
(今回の場合には日付だけが有効な <code>DateTime</code> 型です)。</p>

<h3>ユニフォーム再サンプリング</h3>

<p>先のセクションでは、「解像度の低い(lower resolution)」キーを持った時系列データへと
サンプリングしたい場合には <code>resampleEquiv</code> が使用できることを説明しました
(例として日時の観測値を日付単位にサンプリングしました)。
しかし先のセクションで説明した関数は、
入力シーケンス中にキーが存在する場合にのみ値を生成します。
つまり観測値が丸一日存在しない場合、その日のデータは結果に含まれないことになります。</p>

<p>入力シーケンスによって指定されている範囲内にある各キーに対して
値を割り当てるようなサンプリングを行いたい場合には
<strong>ユニフォーム再サンプリング</strong> を行うことになります。</p>

<p>ユニフォーム再サンプリングとは、最小および最大の入力キーに対して
(たとえば観測値の最初および最後の日付を取得するような)射影を適用して、
射影空間(たとえばすべての日付)内ですべてのキーを生成し、
生成したキーの中から最善の値をピックアップするものです。</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
<span class="l">27: </span>
<span class="l">28: </span>
<span class="l">29: </span>
<span class="l">30: </span>
<span class="l">31: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// 非ユニフォームな、分散キーを持った入力データを作成します</span>
<span class="c">// (10/3には1つ、10/4には3つ、10/6には2つのデータが含まれます)</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs108', 325)" onmouseover="showTip(event, 'fs108', 325)" class="i">days</span> <span class="o">=</span>
  [ <span class="s">&quot;</span><span class="s">10</span><span class="s">/</span><span class="s">3</span><span class="s">/</span><span class="s">2013</span><span class="s"> </span><span class="s">12</span><span class="s">:</span><span class="s">00</span><span class="s">:</span><span class="s">00</span><span class="s">&quot;</span>; <span class="s">&quot;</span><span class="s">10</span><span class="s">/</span><span class="s">4</span><span class="s">/</span><span class="s">2013</span><span class="s"> </span><span class="s">15</span><span class="s">:</span><span class="s">00</span><span class="s">:</span><span class="s">00</span><span class="s">&quot;</span> 
    <span class="s">&quot;</span><span class="s">10</span><span class="s">/</span><span class="s">4</span><span class="s">/</span><span class="s">2013</span><span class="s"> </span><span class="s">18</span><span class="s">:</span><span class="s">00</span><span class="s">:</span><span class="s">00</span><span class="s">&quot;</span>; <span class="s">&quot;</span><span class="s">10</span><span class="s">/</span><span class="s">4</span><span class="s">/</span><span class="s">2013</span><span class="s"> </span><span class="s">19</span><span class="s">:</span><span class="s">00</span><span class="s">:</span><span class="s">00</span><span class="s">&quot;</span>
    <span class="s">&quot;</span><span class="s">10</span><span class="s">/</span><span class="s">6</span><span class="s">/</span><span class="s">2013</span><span class="s"> </span><span class="s">15</span><span class="s">:</span><span class="s">00</span><span class="s">:</span><span class="s">00</span><span class="s">&quot;</span>; <span class="s">&quot;</span><span class="s">10</span><span class="s">/</span><span class="s">6</span><span class="s">/</span><span class="s">2013</span><span class="s"> </span><span class="s">21</span><span class="s">:</span><span class="s">00</span><span class="s">:</span><span class="s">00</span><span class="s">&quot;</span> ]
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs109', 326)" onmouseover="showTip(event, 'fs109', 326)" class="i">nu</span> <span class="o">=</span> 
  <span onmouseout="hideTip(event, 'fs17', 327)" onmouseover="showTip(event, 'fs17', 327)" class="i">stock1</span> (<span onmouseout="hideTip(event, 'fs21', 328)" onmouseover="showTip(event, 'fs21', 328)" class="i">TimeSpan</span>(<span class="n">24</span>,<span class="n">0</span>,<span class="n">0</span>)) <span class="n">10</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs24', 329)" onmouseover="showTip(event, 'fs24', 329)" class="i">series</span>
  <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs45', 330)" onmouseover="showTip(event, 'fs45', 330)" class="i">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs110', 331)" onmouseover="showTip(event, 'fs110', 331)" class="i">indexWith</span> <span onmouseout="hideTip(event, 'fs108', 332)" onmouseover="showTip(event, 'fs108', 332)" class="i">days</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs45', 333)" onmouseover="showTip(event, 'fs45', 333)" class="i">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs111', 334)" onmouseover="showTip(event, 'fs111', 334)" class="i">mapKeys</span> <span onmouseout="hideTip(event, 'fs14', 335)" onmouseover="showTip(event, 'fs14', 335)" class="i">DateTimeOffset</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs112', 336)" onmouseover="showTip(event, 'fs112', 336)" class="i">Parse</span>

<span class="c">// 日付を基準にして、ユニフォーム再サンプリングを行います。</span>
<span class="c">// 値無しのチャンクに対しては最も近く小さい観測値で埋めます。</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs113', 337)" onmouseover="showTip(event, 'fs113', 337)" class="i">sampled</span> <span class="o">=</span>
  <span onmouseout="hideTip(event, 'fs109', 338)" onmouseover="showTip(event, 'fs109', 338)" class="i">nu</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs45', 339)" onmouseover="showTip(event, 'fs45', 339)" class="i">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs114', 340)" onmouseover="showTip(event, 'fs114', 340)" class="i">resampleUniform</span> <span onmouseout="hideTip(event, 'fs31', 341)" onmouseover="showTip(event, 'fs31', 341)" class="i">Lookup</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs32', 342)" onmouseover="showTip(event, 'fs32', 342)" class="i">ExactOrSmaller</span> 
    (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs115', 343)" onmouseover="showTip(event, 'fs115', 343)" class="i">dt</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs115', 344)" onmouseover="showTip(event, 'fs115', 344)" class="i">dt</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs74', 345)" onmouseover="showTip(event, 'fs74', 345)" class="i">Date</span>) (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs116', 346)" onmouseover="showTip(event, 'fs116', 346)" class="i">dt</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs116', 347)" onmouseover="showTip(event, 'fs116', 347)" class="i">dt</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs117', 348)" onmouseover="showTip(event, 'fs117', 348)" class="i">AddDays</span>(<span class="n">1.0</span>))

<span class="c">// C#フレンドリーなメンバーシンタックスを使用して同じことを行います</span>
<span class="c">// (Lookup.ExactOrSmaller はデフォルト値です)</span>
<span onmouseout="hideTip(event, 'fs109', 349)" onmouseover="showTip(event, 'fs109', 349)" class="i">nu</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs118', 350)" onmouseover="showTip(event, 'fs118', 350)" class="i">ResampleUniform</span>((<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs115', 351)" onmouseover="showTip(event, 'fs115', 351)" class="i">dt</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs115', 352)" onmouseover="showTip(event, 'fs115', 352)" class="i">dt</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs74', 353)" onmouseover="showTip(event, 'fs74', 353)" class="i">Date</span>), (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs116', 354)" onmouseover="showTip(event, 'fs116', 354)" class="i">dt</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs116', 355)" onmouseover="showTip(event, 'fs116', 355)" class="i">dt</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs117', 356)" onmouseover="showTip(event, 'fs117', 356)" class="i">AddDays</span>(<span class="n">1.0</span>)))

<span class="c">// (結果を見やすくするために)</span>
<span class="c">// 日毎に複数列を持つようなフレームへと変換します</span>
<span onmouseout="hideTip(event, 'fs113', 357)" onmouseover="showTip(event, 'fs113', 357)" class="i">sampled</span> 
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs45', 358)" onmouseover="showTip(event, 'fs45', 358)" class="i">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs119', 359)" onmouseover="showTip(event, 'fs119', 359)" class="i">mapValues</span> <span onmouseout="hideTip(event, 'fs45', 360)" onmouseover="showTip(event, 'fs45', 360)" class="i">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs120', 361)" onmouseover="showTip(event, 'fs120', 361)" class="i">indexOrdinally</span>
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs34', 362)" onmouseover="showTip(event, 'fs34', 362)" class="i">Frame</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs121', 363)" onmouseover="showTip(event, 'fs121', 363)" class="i">ofRows</span>
<span class="fsi">val it : Frame&lt;DateTime,int&gt; =</span>
<span class="fsi">             0      1          2                </span>
<span class="fsi">10/3/2013 -&gt; 21.45  &lt;missing&gt;  &lt;missing&gt;        </span>
<span class="fsi">10/4/2013 -&gt; 21.63  19.83      17.51            </span>
<span class="fsi">10/5/2013 -&gt; 17.51  &lt;missing&gt;  &lt;missing&gt;        </span>
<span class="fsi">10/6/2013 -&gt; 18.80  20.93      &lt;missing&gt;        </span></pre>
</td>
</tr>
</table>

<p>ユニフォーム再サンプリングを行うには、元のキーを(再サンプリング後の)キーへと
どのようにして射影するのか(ここでは<code>Date</code>を返しています)、
次のキーをどのように計算するのか(翌日に設定しています)、
そして値無しをどのように補填するのかを指定する必要があります。</p>

<p>再サンプリングの実行後、結果を見やすくするために
データをデータフレームへと変換しています。
それぞれのチャンクには実際の観測時刻がキーとして設定されているため、
これらのキーを(<code>Series.indexOrdinal</code>を使用して)単に整数へと置き換えています。
その結果、各行には日毎の観測値が整列された状態で並びます。</p>

<p>重要なのは各日付に対応する観測値があるということです。
つまり2013年10月5日には対応する観測値が入力中には全くないにもかかわらず、
値を持っています。
再サンプリング関数に <code>Lookup.ExactOrSmaller</code> を指定して呼び出しているため、
前日の最後の観測値である 17.51 が値として採用されています。
(<code>Lookup.ExactOrGreater</code> を指定した場合は 18.80、
<code>Lookup.Exact</code> の場合は空のシリーズになります)</p>

<h3>時系列データのサンプリング</h3>

<p>サンプリング操作として最も一般的に行われるものは、
おそらく <code>TimeSpan</code> を指定して時系列データをサンプリングすることでしょう。
この操作は既に紹介した関数をいくつか使用することで簡単に実現できますが、
ライブラリにはまさにこの用途に適したヘルパー関数が用意されています：</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// 1.7時間毎、1000個の観測値を生成します</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs122', 364)" onmouseover="showTip(event, 'fs122', 364)" class="i">pr</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs24', 365)" onmouseover="showTip(event, 'fs24', 365)" class="i">series</span> <span class="o">&lt;|</span> <span onmouseout="hideTip(event, 'fs17', 366)" onmouseover="showTip(event, 'fs17', 366)" class="i">stock1</span> (<span onmouseout="hideTip(event, 'fs21', 367)" onmouseover="showTip(event, 'fs21', 367)" class="i">TimeSpan</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs104', 368)" onmouseover="showTip(event, 'fs104', 368)" class="i">FromHours</span>(<span class="n">1.7</span>)) <span class="n">1000</span>

<span class="c">// 2時間毎にサンプリングします。</span>
<span class="c">// &#39;Backward&#39; は以前のすべての値をチャンクに含めることを示しています。</span>
<span onmouseout="hideTip(event, 'fs122', 369)" onmouseover="showTip(event, 'fs122', 369)" class="i">pr</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs45', 370)" onmouseover="showTip(event, 'fs45', 370)" class="i">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs123', 371)" onmouseover="showTip(event, 'fs123', 371)" class="i">sampleTime</span> (<span onmouseout="hideTip(event, 'fs21', 372)" onmouseover="showTip(event, 'fs21', 372)" class="i">TimeSpan</span>(<span class="n">2</span>, <span class="n">0</span>, <span class="n">0</span>)) <span onmouseout="hideTip(event, 'fs98', 373)" onmouseover="showTip(event, 'fs98', 373)" class="i">Direction</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs100', 374)" onmouseover="showTip(event, 'fs100', 374)" class="i">Backward</span>

<span class="c">// 同じ処理をメンバーシンタックスで行います。</span>
<span class="c">// &#39;Backward&#39; はデフォルト値です。</span>
<span onmouseout="hideTip(event, 'fs122', 375)" onmouseover="showTip(event, 'fs122', 375)" class="i">pr</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs124', 376)" onmouseover="showTip(event, 'fs124', 376)" class="i">Sample</span>(<span onmouseout="hideTip(event, 'fs21', 377)" onmouseover="showTip(event, 'fs21', 377)" class="i">TimeSpan</span>(<span class="n">2</span>, <span class="n">0</span>, <span class="n">0</span>))

<span class="c">// 2時間毎にサンプリングしつつ、直近の値を取得します</span>
<span onmouseout="hideTip(event, 'fs122', 378)" onmouseover="showTip(event, 'fs122', 378)" class="i">pr</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs45', 379)" onmouseover="showTip(event, 'fs45', 379)" class="i">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs125', 380)" onmouseover="showTip(event, 'fs125', 380)" class="i">sampleTimeInto</span>
  (<span onmouseout="hideTip(event, 'fs21', 381)" onmouseover="showTip(event, 'fs21', 381)" class="i">TimeSpan</span>(<span class="n">2</span>, <span class="n">0</span>, <span class="n">0</span>)) <span onmouseout="hideTip(event, 'fs98', 382)" onmouseover="showTip(event, 'fs98', 382)" class="i">Direction</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs100', 383)" onmouseover="showTip(event, 'fs100', 383)" class="i">Backward</span> <span onmouseout="hideTip(event, 'fs45', 384)" onmouseover="showTip(event, 'fs45', 384)" class="i">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs126', 385)" onmouseover="showTip(event, 'fs126', 385)" class="i">lastValue</span></pre>
</td>
</tr>
</table>

<a name="stats"></a>

<h2>計算および統計</h2>

<p>このチュートリアルの最後のセクションとして、
時系列データに対するいくつかの計算処理について説明します。
ここで紹介する関数の多くは順序づけられていないデータフレームやシリーズも
対象とすることができます。</p>

<h3>シフトおよび差分</h3>

<p>まず最初に、シリーズ内で後に続く値と比較しなければならない場合に
必要になる関数を紹介します。
この処理は既に <code>Series.pairwise</code> で行えることを紹介しました。
たいていの場合、シリーズ全体を処理するような操作を行うことによって
同じ処理が実現できます。</p>

<p>以下の2つの便利な関数があります：</p>

<ul>
<li><code>Series.diff</code> は現在の値とn個前の要素との差分を計算します</li>
<li><code>Series.shift</code> はシリーズの値を特定のオフセット分だけシフトします</li>
</ul>

<p>これらの関数の機能については以下のスニペットを参照してください：</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// 1.7時間毎でサンプリングされたデータを生成します</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs127', 386)" onmouseover="showTip(event, 'fs127', 386)" class="i">sample</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs24', 387)" onmouseover="showTip(event, 'fs24', 387)" class="i">series</span> <span class="o">&lt;|</span> <span onmouseout="hideTip(event, 'fs17', 388)" onmouseover="showTip(event, 'fs17', 388)" class="i">stock1</span> (<span onmouseout="hideTip(event, 'fs21', 389)" onmouseover="showTip(event, 'fs21', 389)" class="i">TimeSpan</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs104', 390)" onmouseover="showTip(event, 'fs104', 390)" class="i">FromHours</span>(<span class="n">1.7</span>)) <span class="n">6</span>

<span class="c">// new[i] = s[i] - s[i-1] となるよう計算します</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs128', 391)" onmouseover="showTip(event, 'fs128', 391)" class="i">diff1</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs127', 392)" onmouseover="showTip(event, 'fs127', 392)" class="i">sample</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs45', 393)" onmouseover="showTip(event, 'fs45', 393)" class="i">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs129', 394)" onmouseover="showTip(event, 'fs129', 394)" class="i">diff</span> <span class="n">1</span>
<span class="c">// 逆順で差分を計算します</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs130', 395)" onmouseover="showTip(event, 'fs130', 395)" class="i">diffM1</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs127', 396)" onmouseover="showTip(event, 'fs127', 396)" class="i">sample</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs45', 397)" onmouseover="showTip(event, 'fs45', 397)" class="i">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs129', 398)" onmouseover="showTip(event, 'fs129', 398)" class="i">diff</span> <span class="o">-</span><span class="n">1</span>

<span class="c">// シリーズの値を1ずつシフトします</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs131', 399)" onmouseover="showTip(event, 'fs131', 399)" class="i">shift1</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs127', 400)" onmouseover="showTip(event, 'fs127', 400)" class="i">sample</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs45', 401)" onmouseover="showTip(event, 'fs45', 401)" class="i">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs132', 402)" onmouseover="showTip(event, 'fs132', 402)" class="i">shift</span> <span class="n">1</span>

<span class="c">// 結果を確認するためにすべての結果を1つのフレームとしてアラインします</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs133', 403)" onmouseover="showTip(event, 'fs133', 403)" class="i">df</span> <span class="o">=</span> 
  [ <span class="s">&quot;</span><span class="s">Shift</span><span class="s"> </span><span class="s">+</span><span class="s">1</span><span class="s">&quot;</span> <span class="o">=&gt;</span> <span onmouseout="hideTip(event, 'fs131', 404)" onmouseover="showTip(event, 'fs131', 404)" class="i">shift1</span> 
    <span class="s">&quot;</span><span class="s">Diff</span><span class="s"> </span><span class="s">+</span><span class="s">1</span><span class="s">&quot;</span> <span class="o">=&gt;</span> <span onmouseout="hideTip(event, 'fs128', 405)" onmouseover="showTip(event, 'fs128', 405)" class="i">diff1</span> 
    <span class="s">&quot;</span><span class="s">Diff</span><span class="s">&quot;</span> <span class="o">=&gt;</span> <span onmouseout="hideTip(event, 'fs127', 406)" onmouseover="showTip(event, 'fs127', 406)" class="i">sample</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs131', 407)" onmouseover="showTip(event, 'fs131', 407)" class="i">shift1</span> 
    <span class="s">&quot;</span><span class="s">Orig</span><span class="s">&quot;</span> <span class="o">=&gt;</span> <span onmouseout="hideTip(event, 'fs127', 408)" onmouseover="showTip(event, 'fs127', 408)" class="i">sample</span> ] <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs34', 409)" onmouseover="showTip(event, 'fs34', 409)" class="i">Frame</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs35', 410)" onmouseover="showTip(event, 'fs35', 410)" class="i">ofColumns</span> 
<span class="fsi">val it : Frame&lt;DateTimeOffset,string&gt; =</span>
<span class="fsi">                 Diff       Diff +1    Orig   Shift +1  </span>
<span class="fsi">  12:00:00 AM -&gt; &lt;missing&gt;  &lt;missing&gt;  21.73  &lt;missing&gt; </span>
<span class="fsi">   1:42:00 AM -&gt;  1.73       1.73      23.47  21.73     </span>
<span class="fsi">   3:24:00 AM -&gt; -0.83      -0.83      22.63  23.47     </span>
<span class="fsi">   5:06:00 AM -&gt;  2.37       2.37      25.01  22.63     </span>
<span class="fsi">   6:48:00 AM -&gt; -1.57      -1.57      23.43  25.01     </span>
<span class="fsi">   8:30:00 AM -&gt;  0.09       0.09      23.52  23.43     </span></pre>
</td>
</tr>
</table>

<p>上のスニペットではまず <code>Series.diff</code> 関数を使用して差分を計算しています。
次に <code>Series.shift</code> の呼び方をデモした後、2つのシリーズに対して2項演算を
行っています(<code>sample - shift</code>)。
詳細については以降のセクションで説明します。
また、ここでは(<code>sample |&gt; Series.diff 1</code> のような)関数表記を使用していますが、
いずれの操作もメンバーシンタックスで呼び出すこともできます。
たいていの場合にはそのほうがコード的に短くなるでしょう。
このことについても次のセクションで説明します。</p>

<h3>演算子と関数</h3>

<p>時系列データでは、<code>log</code> や <code>abs</code> のようなF#の標準関数が多数サポートされています。
また標準的な数値演算子を使用して、シリーズのすべての要素に対して
演算を行うといったこともできます。</p>

<p>シリーズにはインデックスがあるため、
2つのシリーズに対して2項演算を行うことができます。
この場合、シリーズを自動的にアラインして、
対応する要素間で処理を実行することになります。</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// 直前の値と現在の値との差を計算します</span>
<span onmouseout="hideTip(event, 'fs127', 411)" onmouseover="showTip(event, 'fs127', 411)" class="i">sample</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs127', 412)" onmouseover="showTip(event, 'fs127', 412)" class="i">sample</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs134', 413)" onmouseover="showTip(event, 'fs134', 413)" class="i">Shift</span>(<span class="n">1</span>)

<span class="c">// 先の差分に対する自然対数を計算します</span>
<span onmouseout="hideTip(event, 'fs135', 414)" onmouseover="showTip(event, 'fs135', 414)" class="i">log</span> (<span onmouseout="hideTip(event, 'fs127', 415)" onmouseover="showTip(event, 'fs127', 415)" class="i">sample</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs127', 416)" onmouseover="showTip(event, 'fs127', 416)" class="i">sample</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs134', 417)" onmouseover="showTip(event, 'fs134', 417)" class="i">Shift</span>(<span class="n">1</span>))

<span class="c">// 差分の平方を計算します</span>
<span onmouseout="hideTip(event, 'fs127', 418)" onmouseover="showTip(event, 'fs127', 418)" class="i">sample</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs136', 419)" onmouseover="showTip(event, 'fs136', 419)" class="i">Diff</span>(<span class="n">1</span>) <span class="o">**</span> <span class="n">2.0</span>

<span class="c">// 現在の値と前後2つの値の平均値を計算します</span>
(<span onmouseout="hideTip(event, 'fs127', 420)" onmouseover="showTip(event, 'fs127', 420)" class="i">sample</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs134', 421)" onmouseover="showTip(event, 'fs134', 421)" class="i">Shift</span>(<span class="o">-</span><span class="n">1</span>) <span class="o">+</span> <span onmouseout="hideTip(event, 'fs127', 422)" onmouseover="showTip(event, 'fs127', 422)" class="i">sample</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs127', 423)" onmouseover="showTip(event, 'fs127', 423)" class="i">sample</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs134', 424)" onmouseover="showTip(event, 'fs134', 424)" class="i">Shift</span>(<span class="n">2</span>)) <span class="o">/</span> <span class="n">3.0</span>

<span class="c">// 差分の絶対値を計算します</span>
<span onmouseout="hideTip(event, 'fs137', 425)" onmouseover="showTip(event, 'fs137', 425)" class="i">abs</span> (<span onmouseout="hideTip(event, 'fs127', 426)" onmouseover="showTip(event, 'fs127', 426)" class="i">sample</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs127', 427)" onmouseover="showTip(event, 'fs127', 427)" class="i">sample</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs134', 428)" onmouseover="showTip(event, 'fs134', 428)" class="i">Shift</span>(<span class="n">1</span>))

<span class="c">// 平均との差分の絶対値を計算します</span>
<span onmouseout="hideTip(event, 'fs137', 429)" onmouseover="showTip(event, 'fs137', 429)" class="i">abs</span> (<span onmouseout="hideTip(event, 'fs127', 430)" onmouseover="showTip(event, 'fs127', 430)" class="i">sample</span> <span class="o">-</span> (<span onmouseout="hideTip(event, 'fs48', 431)" onmouseover="showTip(event, 'fs48', 431)" class="i">Stats</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs49', 432)" onmouseover="showTip(event, 'fs49', 432)" class="i">mean</span> <span onmouseout="hideTip(event, 'fs127', 433)" onmouseover="showTip(event, 'fs127', 433)" class="i">sample</span>))</pre>
</td>
</tr>
</table>

<p>時系列ライブラリにはこういった方法で呼び出すことのできる関数が多数用意されています。
その他にも、(<code>sin</code>や<code>cos</code>といった)三角関数や、
(<code>round</code> <code>floor</code> <code>ceil</code>といった)ラウンド関数、
(<code>exp</code> <code>log</code> <code>log10</code>といった)対数関数などがあります。
一般的に、標準的な型に使用できるF#の組み込みの数値演算関数に対しては
時系列ライブラリでも同じ機能がサポートされています。</p>

<p>しかしシリーズの全要素に適用可能な計算を行うような、
独自の関数を作成するにはどうしたらよいのでしょう？
では説明していきます：</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
<span class="l">8: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// [-1.0, +1.0] の区間に値を切り詰めます</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs138', 434)" onmouseover="showTip(event, 'fs138', 434)" class="i">adjust</span> <span onmouseout="hideTip(event, 'fs139', 435)" onmouseover="showTip(event, 'fs139', 435)" class="i">v</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs140', 436)" onmouseover="showTip(event, 'fs140', 436)" class="i">min</span> <span class="n">1.0</span> (<span onmouseout="hideTip(event, 'fs141', 437)" onmouseover="showTip(event, 'fs141', 437)" class="i">max</span> <span class="o">-</span><span class="n">1.0</span> <span onmouseout="hideTip(event, 'fs139', 438)" onmouseover="showTip(event, 'fs139', 438)" class="i">v</span>)

<span class="c">// すべての要素を調整します</span>
<span onmouseout="hideTip(event, 'fs138', 439)" onmouseover="showTip(event, 'fs138', 439)" class="i">adjust</span> <span class="o">$</span> <span onmouseout="hideTip(event, 'fs127', 440)" onmouseover="showTip(event, 'fs127', 440)" class="i">sample</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs136', 441)" onmouseover="showTip(event, 'fs136', 441)" class="i">Diff</span>(<span class="n">1</span>)

<span class="c">// $ 演算子は以下の省略形です</span>
<span onmouseout="hideTip(event, 'fs127', 442)" onmouseover="showTip(event, 'fs127', 442)" class="i">sample</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs136', 443)" onmouseover="showTip(event, 'fs136', 443)" class="i">Diff</span>(<span class="n">1</span>) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs45', 444)" onmouseover="showTip(event, 'fs45', 444)" class="i">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs119', 445)" onmouseover="showTip(event, 'fs119', 445)" class="i">mapValues</span> <span onmouseout="hideTip(event, 'fs138', 446)" onmouseover="showTip(event, 'fs138', 446)" class="i">adjust</span></pre>
</td>
</tr>
</table>

<p>一般的に、シリーズ内のすべての値に対して独自の関数を適用する場合の最善の方法は、
(<code>Series.join</code> または <code>Series.joinAlign</code> のいずれかを使用して)
タプルを含む1つのシリーズとしてアラインした後、
<code>Series.mapValues</code> を適用することです。
ライブラリには最後の手順を省略できるように <code>$</code> 演算子が定義されています。
つまり、 <code>f $ s</code> とするとシリーズ <code>s</code> のすべての値に関数 <code>f</code> を適用できます。</p>

<h3>データフレームの操作</h3>

<p>最後に、これまでに紹介した操作の多くがデータフレームに対しても
通用することを説明しましょう。
これは(たとえば複数の株価データやローソク足データのように)
同じような構造をしているアラインされた時系列データを
複数含むようなデータフレームがあるような場合に便利です。</p>

<p>以下のスニペットで用法を確認してください：</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">/// すべての数値列を特定の定数倍にします</span>
<span onmouseout="hideTip(event, 'fs133', 447)" onmouseover="showTip(event, 'fs133', 447)" class="i">df</span> <span class="o">*</span> <span class="n">0.65</span>

<span class="c">// すべての列にあるすべてのシリーズに関数を適用します</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs142', 448)" onmouseover="showTip(event, 'fs142', 448)" class="i">conv</span> <span onmouseout="hideTip(event, 'fs143', 449)" onmouseover="showTip(event, 'fs143', 449)" class="i">x</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs140', 450)" onmouseover="showTip(event, 'fs140', 450)" class="i">min</span> <span onmouseout="hideTip(event, 'fs143', 451)" onmouseover="showTip(event, 'fs143', 451)" class="i">x</span> <span class="n">20.0</span>
<span onmouseout="hideTip(event, 'fs133', 452)" onmouseover="showTip(event, 'fs133', 452)" class="i">df</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs34', 453)" onmouseover="showTip(event, 'fs34', 453)" class="i">Frame</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs144', 454)" onmouseover="showTip(event, 'fs144', 454)" class="i">mapRowValues</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs145', 455)" onmouseover="showTip(event, 'fs145', 455)" class="i">os</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs142', 456)" onmouseover="showTip(event, 'fs142', 456)" class="i">conv</span> <span class="o">$</span> <span onmouseout="hideTip(event, 'fs145', 457)" onmouseover="showTip(event, 'fs145', 457)" class="i">os</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs146', 458)" onmouseover="showTip(event, 'fs146', 458)" class="i">As</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs147', 459)" onmouseover="showTip(event, 'fs147', 459)" class="i">float</span><span class="o">&gt;</span>())
   <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs34', 460)" onmouseover="showTip(event, 'fs34', 460)" class="i">Frame</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs121', 461)" onmouseover="showTip(event, 'fs121', 461)" class="i">ofRows</span>

<span class="c">// 各列の総和を計算して、結果を定数で除算します</span>
<span onmouseout="hideTip(event, 'fs48', 462)" onmouseover="showTip(event, 'fs48', 462)" class="i">Stats</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs148', 463)" onmouseover="showTip(event, 'fs148', 463)" class="i">sum</span> <span onmouseout="hideTip(event, 'fs133', 464)" onmouseover="showTip(event, 'fs133', 464)" class="i">df</span> <span class="o">/</span> <span class="n">6.0</span>
<span class="c">// 総和を各フレーム列の平均で除算します</span>
<span onmouseout="hideTip(event, 'fs48', 465)" onmouseover="showTip(event, 'fs48', 465)" class="i">Stats</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs148', 466)" onmouseover="showTip(event, 'fs148', 466)" class="i">sum</span> <span onmouseout="hideTip(event, 'fs133', 467)" onmouseover="showTip(event, 'fs133', 467)" class="i">df</span> <span class="o">/</span> <span onmouseout="hideTip(event, 'fs48', 468)" onmouseover="showTip(event, 'fs48', 468)" class="i">Stats</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs49', 469)" onmouseover="showTip(event, 'fs49', 469)" class="i">mean</span> <span onmouseout="hideTip(event, 'fs133', 470)" onmouseover="showTip(event, 'fs133', 470)" class="i">df</span></pre>
</td>
</tr>
</table>

<div class="tip" id="fs1">namespace MathNet</div>
<div class="tip" id="fs2">namespace MathNet.Numerics</div>
<div class="tip" id="fs3">namespace MathNet.Numerics.Distributions</div>
<div class="tip" id="fs4">val randomPrice : seed:int -&gt; drift:float -&gt; volatility:float -&gt; initial:float -&gt; start:DateTimeOffset -&gt; span:TimeSpan -&gt; count:int -&gt; seq&lt;DateTimeOffset * float&gt;<br /><br />Full name: Series.randomPrice<br /><em><br /><br />&#160;幾何ブラウン運動を使用して価格を生成します<br />&#160;&#160;- &#39;seed&#39; には乱数生成器のシードを指定します<br />&#160;&#160;- &#39;drift&#39; と &#39;volatility&#39; には価格変動の特性を設定します<br />&#160;&#160;- &#39;initial&#39; と &#39;start&#39; には初期の価格と日付を指定します<br />&#160;&#160;- &#39;span&#39; にはそれぞれの測定の間隔を指定します<br />&#160;&#160;- &#39;count&#39; には生成する値の個数を指定します</em></div>
<div class="tip" id="fs5">val seed : int</div>
<div class="tip" id="fs6">val drift : float</div>
<div class="tip" id="fs7">val volatility : float</div>
<div class="tip" id="fs8">val initial : float</div>
<div class="tip" id="fs9">val start : DateTimeOffset</div>
<div class="tip" id="fs10">val span : TimeSpan</div>
<div class="tip" id="fs11">val count : int</div>
<div class="tip" id="fs12">let dist = Normal(0.0, 1.0, RandomSource=Random(seed))  <br />&#160;&#160;let dt = (span:TimeSpan).TotalDays / 250.0<br />&#160;&#160;let driftExp = (drift - 0.5 * pown volatility 2) * dt<br />&#160;&#160;let randExp = volatility * (sqrt dt)<br />&#160;&#160;((start:DateTimeOffset), initial) |&gt; Seq.unfold (fun (dt, price) -&gt;<br />&#160;&#160;&#160;&#160;let price = price * exp (driftExp + randExp * dist.Sample()) <br />&#160;&#160;&#160;&#160;Some((dt, price), (dt + span, price))) |&gt; Seq.take count</div>
<div class="tip" id="fs13">val today : DateTimeOffset<br /><br />Full name: Series.today</div>
<div class="tip" id="fs14">Multiple items<br />type DateTimeOffset =<br />&#160;&#160;struct<br />&#160;&#160;&#160;&#160;new : dateTime:DateTime -&gt; DateTimeOffset + 5 overloads<br />&#160;&#160;&#160;&#160;member Add : timeSpan:TimeSpan -&gt; DateTimeOffset<br />&#160;&#160;&#160;&#160;member AddDays : days:float -&gt; DateTimeOffset<br />&#160;&#160;&#160;&#160;member AddHours : hours:float -&gt; DateTimeOffset<br />&#160;&#160;&#160;&#160;member AddMilliseconds : milliseconds:float -&gt; DateTimeOffset<br />&#160;&#160;&#160;&#160;member AddMinutes : minutes:float -&gt; DateTimeOffset<br />&#160;&#160;&#160;&#160;member AddMonths : months:int -&gt; DateTimeOffset<br />&#160;&#160;&#160;&#160;member AddSeconds : seconds:float -&gt; DateTimeOffset<br />&#160;&#160;&#160;&#160;member AddTicks : ticks:int64 -&gt; DateTimeOffset<br />&#160;&#160;&#160;&#160;member AddYears : years:int -&gt; DateTimeOffset<br />&#160;&#160;&#160;&#160;...<br />&#160;&#160;end<br /><br />Full name: System.DateTimeOffset<br /><br />--------------------<br />DateTimeOffset()<br />DateTimeOffset(dateTime: DateTime) : unit<br />DateTimeOffset(ticks: int64, offset: TimeSpan) : unit<br />DateTimeOffset(dateTime: DateTime, offset: TimeSpan) : unit<br />DateTimeOffset(year: int, month: int, day: int, hour: int, minute: int, second: int, offset: TimeSpan) : unit<br />DateTimeOffset(year: int, month: int, day: int, hour: int, minute: int, second: int, millisecond: int, offset: TimeSpan) : unit<br />DateTimeOffset(year: int, month: int, day: int, hour: int, minute: int, second: int, millisecond: int, calendar: Globalization.Calendar, offset: TimeSpan) : unit</div>
<div class="tip" id="fs15">Multiple items<br />type DateTime =<br />&#160;&#160;struct<br />&#160;&#160;&#160;&#160;new : ticks:int64 -&gt; DateTime + 10 overloads<br />&#160;&#160;&#160;&#160;member Add : value:TimeSpan -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddDays : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddHours : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddMilliseconds : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddMinutes : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddMonths : months:int -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddSeconds : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddTicks : value:int64 -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddYears : value:int -&gt; DateTime<br />&#160;&#160;&#160;&#160;...<br />&#160;&#160;end<br /><br />Full name: System.DateTime<br /><br />--------------------<br />DateTime()<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(ticks: int64) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(ticks: int64, kind: DateTimeKind) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, calendar: Globalization.Calendar) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int, kind: DateTimeKind) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int, calendar: Globalization.Calendar) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int, millisecond: int) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int, millisecond: int, kind: DateTimeKind) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em></div>
<div class="tip" id="fs16">property DateTime.Today: DateTime</div>
<div class="tip" id="fs17">val stock1 : (TimeSpan -&gt; int -&gt; seq&lt;DateTimeOffset * float&gt;)<br /><br />Full name: Series.stock1</div>
<div class="tip" id="fs18">val stock2 : (TimeSpan -&gt; int -&gt; seq&lt;DateTimeOffset * float&gt;)<br /><br />Full name: Series.stock2</div>
<div class="tip" id="fs19">type Chart =<br />&#160;&#160;static member Area : data:seq&lt;#value&gt; * ?Name:string * ?Title:string * ?Labels:#seq&lt;string&gt; * ?Color:Color * ?XTitle:string * ?YTitle:string -&gt; GenericChart<br />&#160;&#160;static member Area : data:seq&lt;#key * #value&gt; * ?Name:string * ?Title:string * ?Labels:#seq&lt;string&gt; * ?Color:Color * ?XTitle:string * ?YTitle:string -&gt; GenericChart<br />&#160;&#160;static member Bar : data:seq&lt;#value&gt; * ?Name:string * ?Title:string * ?Labels:#seq&lt;string&gt; * ?Color:Color * ?XTitle:string * ?YTitle:string -&gt; GenericChart<br />&#160;&#160;static member Bar : data:seq&lt;#key * #value&gt; * ?Name:string * ?Title:string * ?Labels:#seq&lt;string&gt; * ?Color:Color * ?XTitle:string * ?YTitle:string -&gt; GenericChart<br />&#160;&#160;static member BoxPlotFromData : data:seq&lt;#key * #seq&lt;&#39;a2&gt;&gt; * ?Name:string * ?Title:string * ?Color:Color * ?XTitle:string * ?YTitle:string * ?Percentile:int * ?ShowAverage:bool * ?ShowMedian:bool * ?ShowUnusualValues:bool * ?WhiskerPercentile:int -&gt; GenericChart (requires &#39;a2 :&gt; value)<br />&#160;&#160;static member BoxPlotFromStatistics : data:seq&lt;#key * #value * #value * #value * #value * #value * #value&gt; * ?Name:string * ?Title:string * ?Labels:#seq&lt;string&gt; * ?Color:Color * ?XTitle:string * ?YTitle:string * ?Percentile:int * ?ShowAverage:bool * ?ShowMedian:bool * ?ShowUnusualValues:bool * ?WhiskerPercentile:int -&gt; GenericChart<br />&#160;&#160;static member Bubble : data:seq&lt;#value * #value&gt; * ?Name:string * ?Title:string * ?Labels:#seq&lt;string&gt; * ?Color:Color * ?XTitle:string * ?YTitle:string * ?BubbleMaxSize:int * ?BubbleMinSize:int * ?BubbleScaleMax:float * ?BubbleScaleMin:float * ?UseSizeForLabel:bool -&gt; GenericChart<br />&#160;&#160;static member Bubble : data:seq&lt;#key * #value * #value&gt; * ?Name:string * ?Title:string * ?Labels:#seq&lt;string&gt; * ?Color:Color * ?XTitle:string * ?YTitle:string * ?BubbleMaxSize:int * ?BubbleMinSize:int * ?BubbleScaleMax:float * ?BubbleScaleMin:float * ?UseSizeForLabel:bool -&gt; GenericChart<br />&#160;&#160;static member Candlestick : data:seq&lt;#value * #value * #value * #value&gt; * ?Name:string * ?Title:string * ?Labels:#seq&lt;string&gt; * ?Color:Color * ?XTitle:string * ?YTitle:string -&gt; CandlestickChart<br />&#160;&#160;static member Candlestick : data:seq&lt;#key * #value * #value * #value * #value&gt; * ?Name:string * ?Title:string * ?Labels:#seq&lt;string&gt; * ?Color:Color * ?XTitle:string * ?YTitle:string -&gt; CandlestickChart<br />&#160;&#160;...<br /><br />Full name: FSharp.Charting.Chart</div>
<div class="tip" id="fs20">static member Chart.Combine : charts:seq&lt;ChartTypes.GenericChart&gt; -&gt; ChartTypes.GenericChart</div>
<div class="tip" id="fs21">Multiple items<br />type TimeSpan =<br />&#160;&#160;struct<br />&#160;&#160;&#160;&#160;new : ticks:int64 -&gt; TimeSpan + 3 overloads<br />&#160;&#160;&#160;&#160;member Add : ts:TimeSpan -&gt; TimeSpan<br />&#160;&#160;&#160;&#160;member CompareTo : value:obj -&gt; int + 1 overload<br />&#160;&#160;&#160;&#160;member Days : int<br />&#160;&#160;&#160;&#160;member Duration : unit -&gt; TimeSpan<br />&#160;&#160;&#160;&#160;member Equals : value:obj -&gt; bool + 1 overload<br />&#160;&#160;&#160;&#160;member GetHashCode : unit -&gt; int<br />&#160;&#160;&#160;&#160;member Hours : int<br />&#160;&#160;&#160;&#160;member Milliseconds : int<br />&#160;&#160;&#160;&#160;member Minutes : int<br />&#160;&#160;&#160;&#160;...<br />&#160;&#160;end<br /><br />Full name: System.TimeSpan<br /><br />--------------------<br />TimeSpan()<br />TimeSpan(ticks: int64) : unit<br />TimeSpan(hours: int, minutes: int, seconds: int) : unit<br />TimeSpan(days: int, hours: int, minutes: int, seconds: int) : unit<br />TimeSpan(days: int, hours: int, minutes: int, seconds: int, milliseconds: int) : unit</div>
<div class="tip" id="fs22">static member Chart.FastLine : data:seq&lt;#value&gt; * ?Name:string * ?Title:string * ?Labels:#seq&lt;string&gt; * ?Color:Drawing.Color * ?XTitle:string * ?YTitle:string -&gt; ChartTypes.GenericChart<br />static member Chart.FastLine : data:seq&lt;#key * #value&gt; * ?Name:string * ?Title:string * ?Labels:#seq&lt;string&gt; * ?Color:Drawing.Color * ?XTitle:string * ?YTitle:string -&gt; ChartTypes.GenericChart</div>
<div class="tip" id="fs23">val s1 : Series&lt;DateTimeOffset,float&gt;<br /><br />Full name: Series.s1</div>
<div class="tip" id="fs24">val series : observations:seq&lt;&#39;a * &#39;b&gt; -&gt; Series&lt;&#39;a,&#39;b&gt; (requires equality)<br /><br />Full name: Deedle.FSharpSeriesExtensions.series</div>
<div class="tip" id="fs25">val s2 : Series&lt;DateTimeOffset,float&gt;<br /><br />Full name: Series.s2</div>
<div class="tip" id="fs26">val s3 : Series&lt;DateTimeOffset,float&gt;<br /><br />Full name: Series.s3</div>
<div class="tip" id="fs27">member Series.Zip : otherSeries:Series&lt;&#39;K,&#39;V2&gt; -&gt; Series&lt;&#39;K,(&#39;V opt * &#39;V2 opt)&gt;<br />member Series.Zip : otherSeries:Series&lt;&#39;K,&#39;V2&gt; * kind:JoinKind -&gt; Series&lt;&#39;K,(&#39;V opt * &#39;V2 opt)&gt;<br />member Series.Zip : otherSeries:Series&lt;&#39;K,&#39;V2&gt; * kind:JoinKind * lookup:Lookup -&gt; Series&lt;&#39;K,(&#39;V opt * &#39;V2 opt)&gt;</div>
<div class="tip" id="fs28">type JoinKind =<br />&#160;&#160;|  Outer  =  0<br />&#160;&#160;|  Inner  =  1<br />&#160;&#160;|  Left  =  2<br />&#160;&#160;|  Right  =  3<br /><br />Full name: Deedle.JoinKind</div>
<div class="tip" id="fs29">JoinKind.Left: JoinKind = 2</div>
<div class="tip" id="fs30">JoinKind.Right: JoinKind = 3</div>
<div class="tip" id="fs31">type Lookup =<br />&#160;&#160;|  Exact  =  1<br />&#160;&#160;|  ExactOrGreater  =  3<br />&#160;&#160;|  ExactOrSmaller  =  5<br />&#160;&#160;|  Greater  =  2<br />&#160;&#160;|  Smaller  =  4<br /><br />Full name: Deedle.Lookup</div>
<div class="tip" id="fs32">Lookup.ExactOrSmaller: Lookup = 5</div>
<div class="tip" id="fs33">val f1 : Frame&lt;DateTimeOffset,string&gt;<br /><br />Full name: Series.f1</div>
<div class="tip" id="fs34">Multiple items<br />module Frame<br /><br />from Deedle<br /><br />--------------------<br />type Frame =<br />&#160;&#160;static member CreateEmpty : unit -&gt; Frame&lt;&#39;R,&#39;C&gt; (requires equality and equality)<br />&#160;&#160;static member FromArray2D : array:&#39;T [,] -&gt; Frame&lt;int,int&gt;<br />&#160;&#160;static member FromColumns : cols:Series&lt;&#39;TColKey,Series&lt;&#39;TRowKey,&#39;V&gt;&gt; -&gt; Frame&lt;&#39;TRowKey,&#39;TColKey&gt; (requires equality and equality)<br />&#160;&#160;static member FromColumns : cols:Series&lt;&#39;TColKey,ObjectSeries&lt;&#39;TRowKey&gt;&gt; -&gt; Frame&lt;&#39;TRowKey,&#39;TColKey&gt; (requires equality and equality)<br />&#160;&#160;static member FromColumns : columns:seq&lt;KeyValuePair&lt;&#39;ColKey,ObjectSeries&lt;&#39;RowKey&gt;&gt;&gt; -&gt; Frame&lt;&#39;RowKey,&#39;ColKey&gt; (requires equality and equality)<br />&#160;&#160;static member FromColumns : columns:seq&lt;KeyValuePair&lt;&#39;ColKey,Series&lt;&#39;RowKey,&#39;V&gt;&gt;&gt; -&gt; Frame&lt;&#39;RowKey,&#39;ColKey&gt; (requires equality and equality)<br />&#160;&#160;static member FromColumns : rows:seq&lt;Series&lt;&#39;ColKey,&#39;V&gt;&gt; -&gt; Frame&lt;&#39;ColKey,int&gt; (requires equality)<br />&#160;&#160;static member FromRecords : values:seq&lt;&#39;T&gt; -&gt; Frame&lt;int,string&gt;<br />&#160;&#160;static member FromRecords : series:Series&lt;&#39;K,&#39;R&gt; -&gt; Frame&lt;&#39;K,string&gt; (requires equality)<br />&#160;&#160;static member FromRowKeys : keys:seq&lt;&#39;K&gt; -&gt; Frame&lt;&#39;K,string&gt; (requires equality)<br />&#160;&#160;...<br /><br />Full name: Deedle.Frame<br /><br />--------------------<br />type Frame&lt;&#39;TRowKey,&#39;TColumnKey (requires equality and equality)&gt; =<br />&#160;&#160;interface IDynamicMetaObjectProvider<br />&#160;&#160;interface INotifyCollectionChanged<br />&#160;&#160;interface IFsiFormattable<br />&#160;&#160;interface IFrame<br />&#160;&#160;new : names:seq&lt;&#39;TColumnKey&gt; * columns:seq&lt;ISeries&lt;&#39;TRowKey&gt;&gt; -&gt; Frame&lt;&#39;TRowKey,&#39;TColumnKey&gt;<br />&#160;&#160;private new : rowIndex:IIndex&lt;&#39;TRowKey&gt; * columnIndex:IIndex&lt;&#39;TColumnKey&gt; * data:IVector&lt;IVector&gt; -&gt; Frame&lt;&#39;TRowKey,&#39;TColumnKey&gt;<br />&#160;&#160;member AddColumn : column:&#39;TColumnKey * series:ISeries&lt;&#39;TRowKey&gt; -&gt; unit<br />&#160;&#160;member AddColumn : column:&#39;TColumnKey * series:seq&lt;&#39;V&gt; -&gt; unit<br />&#160;&#160;member AddColumn : column:&#39;TColumnKey * series:ISeries&lt;&#39;TRowKey&gt; * lookup:Lookup -&gt; unit<br />&#160;&#160;member AddColumn : column:&#39;TColumnKey * series:seq&lt;&#39;V&gt; * lookup:Lookup -&gt; unit<br />&#160;&#160;...<br /><br />Full name: Deedle.Frame&lt;_,_&gt;<br /><br />--------------------<br />new : names:seq&lt;&#39;TColumnKey&gt; * columns:seq&lt;ISeries&lt;&#39;TRowKey&gt;&gt; -&gt; Frame&lt;&#39;TRowKey,&#39;TColumnKey&gt;</div>
<div class="tip" id="fs35">static member Frame.ofColumns : cols:Series&lt;&#39;a0,#ISeries&lt;&#39;a2&gt;&gt; -&gt; Frame&lt;&#39;a2,&#39;a0&gt; (requires equality and equality)<br />static member Frame.ofColumns : cols:seq&lt;&#39;a0 * #ISeries&lt;&#39;K&gt;&gt; -&gt; Frame&lt;&#39;K,&#39;a0&gt; (requires equality and equality)</div>
<div class="tip" id="fs36">val f2 : Frame&lt;DateTimeOffset,string&gt;<br /><br />Full name: Series.f2</div>
<div class="tip" id="fs37">val f3 : Frame&lt;DateTimeOffset,string&gt;<br /><br />Full name: Series.f3</div>
<div class="tip" id="fs38">member Frame.Join : otherFrame:Frame&lt;&#39;TRowKey,&#39;TColumnKey&gt; -&gt; Frame&lt;&#39;TRowKey,&#39;TColumnKey&gt;<br />member Frame.Join : colKey:&#39;TColumnKey * series:Series&lt;&#39;TRowKey,&#39;V&gt; -&gt; Frame&lt;&#39;TRowKey,&#39;TColumnKey&gt;<br />member Frame.Join : otherFrame:Frame&lt;&#39;TRowKey,&#39;TColumnKey&gt; * kind:JoinKind -&gt; Frame&lt;&#39;TRowKey,&#39;TColumnKey&gt;<br />member Frame.Join : colKey:&#39;TColumnKey * series:Series&lt;&#39;TRowKey,&#39;V&gt; * kind:JoinKind -&gt; Frame&lt;&#39;TRowKey,&#39;TColumnKey&gt;<br />member Frame.Join : otherFrame:Frame&lt;&#39;TRowKey,&#39;TColumnKey&gt; * kind:JoinKind * lookup:Lookup -&gt; Frame&lt;&#39;TRowKey,&#39;TColumnKey&gt;<br />member Frame.Join : colKey:&#39;TColumnKey * series:Series&lt;&#39;TRowKey,&#39;V&gt; * kind:JoinKind * lookup:Lookup -&gt; Frame&lt;&#39;TRowKey,&#39;TColumnKey&gt;</div>
<div class="tip" id="fs39">JoinKind.Outer: JoinKind = 0</div>
<div class="tip" id="fs40">JoinKind.Inner: JoinKind = 1</div>
<div class="tip" id="fs41">Lookup.Exact: Lookup = 1</div>
<div class="tip" id="fs42">val join : kind:JoinKind -&gt; frame1:Frame&lt;&#39;R,&#39;C&gt; -&gt; frame2:Frame&lt;&#39;R,&#39;C&gt; -&gt; Frame&lt;&#39;R,&#39;C&gt; (requires equality and equality)<br /><br />Full name: Deedle.Frame.join</div>
<div class="tip" id="fs43">val joinAlign : kind:JoinKind -&gt; lookup:Lookup -&gt; frame1:Frame&lt;&#39;R,&#39;C&gt; -&gt; frame2:Frame&lt;&#39;R,&#39;C&gt; -&gt; Frame&lt;&#39;R,&#39;C&gt; (requires equality and equality)<br /><br />Full name: Deedle.Frame.joinAlign</div>
<div class="tip" id="fs44">val lf : Series&lt;DateTimeOffset,float&gt;<br /><br />Full name: Series.lf</div>
<div class="tip" id="fs45">Multiple items<br />module Series<br /><br />from Deedle<br /><br />--------------------<br />type Series =<br />&#160;&#160;static member ofNullables : values:seq&lt;Nullable&lt;&#39;a0&gt;&gt; -&gt; Series&lt;int,&#39;a0&gt; (requires default constructor and value type and &#39;a0 :&gt; ValueType)<br />&#160;&#160;static member ofObservations : observations:seq&lt;&#39;a0 * &#39;a1&gt; -&gt; Series&lt;&#39;a0,&#39;a1&gt; (requires equality)<br />&#160;&#160;static member ofOptionalObservations : observations:seq&lt;&#39;K * &#39;a1 option&gt; -&gt; Series&lt;&#39;K,&#39;a1&gt; (requires equality)<br />&#160;&#160;static member ofValues : values:seq&lt;&#39;a0&gt; -&gt; Series&lt;int,&#39;a0&gt;<br /><br />Full name: Deedle.FSharpSeriesExtensions.Series<br /><br />--------------------<br />type Series&lt;&#39;K,&#39;V (requires equality)&gt; =<br />&#160;&#160;interface IFsiFormattable<br />&#160;&#160;interface ISeries&lt;&#39;K&gt;<br />&#160;&#160;new : pairs:seq&lt;KeyValuePair&lt;&#39;K,&#39;V&gt;&gt; -&gt; Series&lt;&#39;K,&#39;V&gt;<br />&#160;&#160;new : keys:seq&lt;&#39;K&gt; * values:seq&lt;&#39;V&gt; -&gt; Series&lt;&#39;K,&#39;V&gt;<br />&#160;&#160;new : index:IIndex&lt;&#39;K&gt; * vector:IVector&lt;&#39;V&gt; * vectorBuilder:IVectorBuilder * indexBuilder:IIndexBuilder -&gt; Series&lt;&#39;K,&#39;V&gt;<br />&#160;&#160;member After : lowerExclusive:&#39;K -&gt; Series&lt;&#39;K,&#39;V&gt;<br />&#160;&#160;member Aggregate : aggregation:Aggregation&lt;&#39;K&gt; * observationSelector:Func&lt;DataSegment&lt;Series&lt;&#39;K,&#39;V&gt;&gt;,KeyValuePair&lt;&#39;TNewKey,OptionalValue&lt;&#39;R&gt;&gt;&gt; -&gt; Series&lt;&#39;TNewKey,&#39;R&gt; (requires equality)<br />&#160;&#160;member Aggregate : aggregation:Aggregation&lt;&#39;K&gt; * keySelector:Func&lt;DataSegment&lt;Series&lt;&#39;K,&#39;V&gt;&gt;,&#39;TNewKey&gt; * valueSelector:Func&lt;DataSegment&lt;Series&lt;&#39;K,&#39;V&gt;&gt;,OptionalValue&lt;&#39;R&gt;&gt; -&gt; Series&lt;&#39;TNewKey,&#39;R&gt; (requires equality)<br />&#160;&#160;member AsyncMaterialize : unit -&gt; Async&lt;Series&lt;&#39;K,&#39;V&gt;&gt;<br />&#160;&#160;member Before : upperExclusive:&#39;K -&gt; Series&lt;&#39;K,&#39;V&gt;<br />&#160;&#160;...<br /><br />Full name: Deedle.Series&lt;_,_&gt;<br /><br />--------------------<br />new : pairs:seq&lt;Collections.Generic.KeyValuePair&lt;&#39;K,&#39;V&gt;&gt; -&gt; Series&lt;&#39;K,&#39;V&gt;<br />new : keys:seq&lt;&#39;K&gt; * values:seq&lt;&#39;V&gt; -&gt; Series&lt;&#39;K,&#39;V&gt;<br />new : index:Indices.IIndex&lt;&#39;K&gt; * vector:IVector&lt;&#39;V&gt; * vectorBuilder:Vectors.IVectorBuilder * indexBuilder:Indices.IIndexBuilder -&gt; Series&lt;&#39;K,&#39;V&gt;</div>
<div class="tip" id="fs46">val window : size:int -&gt; series:Series&lt;&#39;K,&#39;T&gt; -&gt; Series&lt;&#39;K,Series&lt;&#39;K,&#39;T&gt;&gt; (requires equality)<br /><br />Full name: Deedle.Series.window</div>
<div class="tip" id="fs47">val windowInto : size:int -&gt; f:(Series&lt;&#39;K,&#39;T&gt; -&gt; &#39;R) -&gt; series:Series&lt;&#39;K,&#39;T&gt; -&gt; Series&lt;&#39;K,&#39;R&gt; (requires equality)<br /><br />Full name: Deedle.Series.windowInto</div>
<div class="tip" id="fs48">type Stats =<br />&#160;&#160;static member count : frame:Frame&lt;&#39;R,&#39;C&gt; -&gt; Series&lt;&#39;C,int&gt; (requires equality and equality)<br />&#160;&#160;static member count : series:Series&lt;&#39;K,&#39;V&gt; -&gt; int (requires equality)<br />&#160;&#160;static member expandingCount : series:Series&lt;&#39;K,float&gt; -&gt; Series&lt;&#39;K,float&gt; (requires equality)<br />&#160;&#160;static member expandingKurt : series:Series&lt;&#39;K,float&gt; -&gt; Series&lt;&#39;K,float&gt; (requires equality)<br />&#160;&#160;static member expandingMax : series:Series&lt;&#39;K,float&gt; -&gt; Series&lt;&#39;K,float&gt; (requires equality)<br />&#160;&#160;static member expandingMean : series:Series&lt;&#39;K,float&gt; -&gt; Series&lt;&#39;K,float&gt; (requires equality)<br />&#160;&#160;static member expandingMin : series:Series&lt;&#39;K,float&gt; -&gt; Series&lt;&#39;K,float&gt; (requires equality)<br />&#160;&#160;static member expandingSkew : series:Series&lt;&#39;K,float&gt; -&gt; Series&lt;&#39;K,float&gt; (requires equality)<br />&#160;&#160;static member expandingStdDev : series:Series&lt;&#39;K,float&gt; -&gt; Series&lt;&#39;K,float&gt; (requires equality)<br />&#160;&#160;static member expandingSum : series:Series&lt;&#39;K,float&gt; -&gt; Series&lt;&#39;K,float&gt; (requires equality)<br />&#160;&#160;...<br /><br />Full name: Deedle.Stats</div>
<div class="tip" id="fs49">static member Stats.mean : frame:Frame&lt;&#39;R,&#39;C&gt; -&gt; Series&lt;&#39;C,float&gt; (requires equality and equality)<br />static member Stats.mean : series:Series&lt;&#39;K,float&gt; -&gt; float (requires equality)</div>
<div class="tip" id="fs50">val firstValue : series:Series&lt;&#39;K,&#39;V&gt; -&gt; &#39;V (requires equality)<br /><br />Full name: Deedle.Series.firstValue</div>
<div class="tip" id="fs51">val lfm1 : Series&lt;DateTimeOffset,float&gt;<br /><br />Full name: Series.lfm1</div>
<div class="tip" id="fs52">val lfm2 : Series&lt;DateTimeOffset,float&gt;<br /><br />Full name: Series.lfm2</div>
<div class="tip" id="fs53">val windowSizeInto : int * Boundary -&gt; f:(DataSegment&lt;Series&lt;&#39;K,&#39;T&gt;&gt; -&gt; &#39;R) -&gt; series:Series&lt;&#39;K,&#39;T&gt; -&gt; Series&lt;&#39;K,&#39;R&gt; (requires equality)<br /><br />Full name: Deedle.Series.windowSizeInto</div>
<div class="tip" id="fs54">type Boundary =<br />&#160;&#160;|  AtBeginning  =  1<br />&#160;&#160;|  AtEnding  =  2<br />&#160;&#160;|  Skip  =  4<br /><br />Full name: Deedle.Boundary</div>
<div class="tip" id="fs55">Boundary.AtBeginning: Boundary = 1</div>
<div class="tip" id="fs56">val ds : DataSegment&lt;Series&lt;DateTimeOffset,float&gt;&gt;</div>
<div class="tip" id="fs57">property DataSegment.Data: Series&lt;DateTimeOffset,float&gt;</div>
<div class="tip" id="fs58">val st : Series&lt;int,char&gt;<br /><br />Full name: Series.st</div>
<div class="tip" id="fs59">static member Series.ofValues : values:seq&lt;&#39;a0&gt; -&gt; Series&lt;int,&#39;a0&gt;</div>
<div class="tip" id="fs60">Boundary.AtEnding: Boundary = 2</div>
<div class="tip" id="fs61">Multiple items<br />union case DataSegment.DataSegment: DataSegmentKind * &#39;T -&gt; DataSegment&lt;&#39;T&gt;<br /><br />--------------------<br />module DataSegment<br /><br />from Deedle<br /><br />--------------------<br />type DataSegment&lt;&#39;T&gt; =<br />&#160;&#160;| DataSegment of DataSegmentKind * &#39;T<br />&#160;&#160;override ToString : unit -&gt; string<br />&#160;&#160;member Data : &#39;T<br />&#160;&#160;member Kind : DataSegmentKind<br /><br />Full name: Deedle.DataSegment&lt;_&gt;</div>
<div class="tip" id="fs62">active recognizer Complete: DataSegment&lt;&#39;a&gt; -&gt; Choice&lt;&#39;a,&#39;a&gt;<br /><br />Full name: Deedle.DataSegment.( |Complete|Incomplete| )</div>
<div class="tip" id="fs63">val ser : Series&lt;int,char&gt;</div>
<div class="tip" id="fs64">Multiple items<br />type String =<br />&#160;&#160;new : value:char -&gt; string + 7 overloads<br />&#160;&#160;member Chars : int -&gt; char<br />&#160;&#160;member Clone : unit -&gt; obj<br />&#160;&#160;member CompareTo : value:obj -&gt; int + 1 overload<br />&#160;&#160;member Contains : value:string -&gt; bool<br />&#160;&#160;member CopyTo : sourceIndex:int * destination:char[] * destinationIndex:int * count:int -&gt; unit<br />&#160;&#160;member EndsWith : value:string -&gt; bool + 2 overloads<br />&#160;&#160;member Equals : obj:obj -&gt; bool + 2 overloads<br />&#160;&#160;member GetEnumerator : unit -&gt; CharEnumerator<br />&#160;&#160;member GetHashCode : unit -&gt; int<br />&#160;&#160;...<br /><br />Full name: System.String<br /><br />--------------------<br />String(value: nativeptr&lt;char&gt;) : unit<br />String(value: nativeptr&lt;sbyte&gt;) : unit<br />String(value: char []) : unit<br />String(c: char, count: int) : unit<br />String(value: nativeptr&lt;char&gt;, startIndex: int, length: int) : unit<br />String(value: nativeptr&lt;sbyte&gt;, startIndex: int, length: int) : unit<br />String(value: char [], startIndex: int, length: int) : unit<br />String(value: nativeptr&lt;sbyte&gt;, startIndex: int, length: int, enc: Text.Encoding) : unit</div>
<div class="tip" id="fs65">val values : series:Series&lt;&#39;K,&#39;T&gt; -&gt; seq&lt;&#39;T&gt; (requires equality)<br /><br />Full name: Deedle.Series.values</div>
<div class="tip" id="fs66">type Array =<br />&#160;&#160;member Clone : unit -&gt; obj<br />&#160;&#160;member CopyTo : array:Array * index:int -&gt; unit + 1 overload<br />&#160;&#160;member GetEnumerator : unit -&gt; IEnumerator<br />&#160;&#160;member GetLength : dimension:int -&gt; int<br />&#160;&#160;member GetLongLength : dimension:int -&gt; int64<br />&#160;&#160;member GetLowerBound : dimension:int -&gt; int<br />&#160;&#160;member GetUpperBound : dimension:int -&gt; int<br />&#160;&#160;member GetValue : params indices:int[] -&gt; obj + 7 overloads<br />&#160;&#160;member Initialize : unit -&gt; unit<br />&#160;&#160;member IsFixedSize : bool<br />&#160;&#160;...<br /><br />Full name: System.Array</div>
<div class="tip" id="fs67">val ofSeq : source:seq&lt;&#39;T&gt; -&gt; &#39;T []<br /><br />Full name: Microsoft.FSharp.Collections.Array.ofSeq</div>
<div class="tip" id="fs68">active recognizer Incomplete: DataSegment&lt;&#39;a&gt; -&gt; Choice&lt;&#39;a,&#39;a&gt;<br /><br />Full name: Deedle.DataSegment.( |Complete|Incomplete| )</div>
<div class="tip" id="fs69">val hourly : Series&lt;DateTimeOffset,float&gt;<br /><br />Full name: Series.hourly</div>
<div class="tip" id="fs70">val windowDist : distance:&#39;D -&gt; series:Series&lt;&#39;K,&#39;T&gt; -&gt; Series&lt;&#39;K,Series&lt;&#39;K,&#39;T&gt;&gt; (requires comparison and equality and member ( - ))<br /><br />Full name: Deedle.Series.windowDist</div>
<div class="tip" id="fs71">val windowWhile : cond:(&#39;K -&gt; &#39;K -&gt; bool) -&gt; series:Series&lt;&#39;K,&#39;T&gt; -&gt; Series&lt;&#39;K,Series&lt;&#39;K,&#39;T&gt;&gt; (requires equality)<br /><br />Full name: Deedle.Series.windowWhile</div>
<div class="tip" id="fs72">val d1 : DateTimeOffset</div>
<div class="tip" id="fs73">val d2 : DateTimeOffset</div>
<div class="tip" id="fs74">property DateTimeOffset.Date: DateTime</div>
<div class="tip" id="fs75">val hf : Series&lt;DateTimeOffset,float&gt;<br /><br />Full name: Series.hf</div>
<div class="tip" id="fs76">val chunkSize : int * Boundary -&gt; series:Series&lt;&#39;K,&#39;T&gt; -&gt; Series&lt;&#39;K,Series&lt;&#39;K,&#39;T&gt;&gt; (requires equality)<br /><br />Full name: Deedle.Series.chunkSize</div>
<div class="tip" id="fs77">val chunkDistInto : distance:&#39;D -&gt; f:(Series&lt;&#39;K,&#39;T&gt; -&gt; &#39;R) -&gt; series:Series&lt;&#39;K,&#39;T&gt; -&gt; Series&lt;&#39;K,&#39;R&gt; (requires comparison and equality and member ( - ))<br /><br />Full name: Deedle.Series.chunkDistInto</div>
<div class="tip" id="fs78">val chunkWhile : cond:(&#39;K -&gt; &#39;K -&gt; bool) -&gt; series:Series&lt;&#39;K,&#39;T&gt; -&gt; Series&lt;&#39;K,Series&lt;&#39;K,&#39;T&gt;&gt; (requires equality)<br /><br />Full name: Deedle.Series.chunkWhile</div>
<div class="tip" id="fs79">val k1 : DateTimeOffset</div>
<div class="tip" id="fs80">val k2 : DateTimeOffset</div>
<div class="tip" id="fs81">property DateTimeOffset.Hour: int</div>
<div class="tip" id="fs82">property DateTimeOffset.Minute: int</div>
<div class="tip" id="fs83">val pairwise : series:Series&lt;&#39;K,&#39;T&gt; -&gt; Series&lt;&#39;K,(&#39;T * &#39;T)&gt; (requires equality)<br /><br />Full name: Deedle.Series.pairwise</div>
<div class="tip" id="fs84">val pairwiseWith : f:(&#39;K -&gt; &#39;T * &#39;T -&gt; &#39;a) -&gt; series:Series&lt;&#39;K,&#39;T&gt; -&gt; Series&lt;&#39;K,&#39;a&gt; (requires equality)<br /><br />Full name: Deedle.Series.pairwiseWith</div>
<div class="tip" id="fs85">val k : DateTimeOffset</div>
<div class="tip" id="fs86">val v1 : float</div>
<div class="tip" id="fs87">val v2 : float</div>
<div class="tip" id="fs88">val s : Series&lt;DateTimeOffset,float&gt;</div>
<div class="tip" id="fs89">member Series.GetAt : index:int -&gt; &#39;V</div>
<div class="tip" id="fs90">val mf : Series&lt;DateTimeOffset,float&gt;<br /><br />Full name: Series.mf</div>
<div class="tip" id="fs91">TimeSpan.FromSeconds(value: float) : TimeSpan</div>
<div class="tip" id="fs92">val keys : DateTimeOffset list<br /><br />Full name: Series.keys</div>
<div class="tip" id="fs93">val m : float</div>
<div class="tip" id="fs94">DateTimeOffset.AddMinutes(minutes: float) : DateTimeOffset</div>
<div class="tip" id="fs95">val lookupAll : keys:seq&lt;&#39;K&gt; -&gt; lookup:Lookup -&gt; series:Series&lt;&#39;K,&#39;T&gt; -&gt; Series&lt;&#39;K,&#39;T&gt; (requires equality)<br /><br />Full name: Deedle.Series.lookupAll</div>
<div class="tip" id="fs96">Lookup.ExactOrGreater: Lookup = 3</div>
<div class="tip" id="fs97">val resample : keys:seq&lt;&#39;K&gt; -&gt; dir:Direction -&gt; series:Series&lt;&#39;K,&#39;V&gt; -&gt; Series&lt;&#39;K,Series&lt;&#39;K,&#39;V&gt;&gt; (requires equality)<br /><br />Full name: Deedle.Series.resample</div>
<div class="tip" id="fs98">type Direction =<br />&#160;&#160;|  Backward  =  0<br />&#160;&#160;|  Forward  =  1<br /><br />Full name: Deedle.Direction</div>
<div class="tip" id="fs99">Direction.Forward: Direction = 1</div>
<div class="tip" id="fs100">Direction.Backward: Direction = 0</div>
<div class="tip" id="fs101">val resampleInto : keys:seq&lt;&#39;K&gt; -&gt; dir:Direction -&gt; f:(&#39;K -&gt; Series&lt;&#39;K,&#39;V&gt; -&gt; &#39;a) -&gt; series:Series&lt;&#39;K,&#39;V&gt; -&gt; Series&lt;&#39;K,&#39;a&gt; (requires equality)<br /><br />Full name: Deedle.Series.resampleInto</div>
<div class="tip" id="fs102">member Series.Resample : keys:seq&lt;&#39;K&gt; * direction:Direction -&gt; Series&lt;&#39;K,Series&lt;&#39;K,&#39;V&gt;&gt;<br />member Series.Resample : keys:seq&lt;&#39;K&gt; * direction:Direction * valueSelector:Func&lt;&#39;K,Series&lt;&#39;K,&#39;V&gt;,&#39;a2&gt; -&gt; Series&lt;&#39;K,&#39;a2&gt;<br />member Series.Resample : keys:seq&lt;&#39;K&gt; * direction:Direction * valueSelector:Func&lt;&#39;TNewKey,Series&lt;&#39;K,&#39;V&gt;,&#39;R&gt; * keySelector:Func&lt;&#39;K,Series&lt;&#39;K,&#39;V&gt;,&#39;TNewKey&gt; -&gt; Series&lt;&#39;TNewKey,&#39;R&gt; (requires equality)</div>
<div class="tip" id="fs103">val ds : Series&lt;DateTimeOffset,float&gt;<br /><br />Full name: Series.ds</div>
<div class="tip" id="fs104">TimeSpan.FromHours(value: float) : TimeSpan</div>
<div class="tip" id="fs105">val resampleEquiv : keyProj:(&#39;K1 -&gt; &#39;K2) -&gt; series:Series&lt;&#39;K1,&#39;V1&gt; -&gt; Series&lt;&#39;K2,Series&lt;&#39;K1,&#39;V1&gt;&gt; (requires equality and equality)<br /><br />Full name: Deedle.Series.resampleEquiv</div>
<div class="tip" id="fs106">val d : DateTimeOffset</div>
<div class="tip" id="fs107">static member SeriesExtensions.ResampleEquivalence : series:Series&lt;&#39;K,&#39;V&gt; * keyProj:Func&lt;&#39;K,&#39;a2&gt; -&gt; Series&lt;&#39;a2,Series&lt;&#39;K,&#39;V&gt;&gt; (requires equality and equality)<br />static member SeriesExtensions.ResampleEquivalence : series:Series&lt;&#39;K,&#39;V&gt; * keyProj:Func&lt;&#39;K,&#39;a2&gt; * aggregate:Func&lt;Series&lt;&#39;K,&#39;V&gt;,&#39;a3&gt; -&gt; Series&lt;&#39;a2,&#39;a3&gt; (requires equality and equality)</div>
<div class="tip" id="fs108">val days : string list<br /><br />Full name: Series.days</div>
<div class="tip" id="fs109">val nu : Series&lt;DateTimeOffset,float&gt;<br /><br />Full name: Series.nu</div>
<div class="tip" id="fs110">val indexWith : keys:seq&lt;&#39;K2&gt; -&gt; series:Series&lt;&#39;K1,&#39;T&gt; -&gt; Series&lt;&#39;K2,&#39;T&gt; (requires equality and equality)<br /><br />Full name: Deedle.Series.indexWith</div>
<div class="tip" id="fs111">val mapKeys : f:(&#39;K -&gt; &#39;R) -&gt; series:Series&lt;&#39;K,&#39;T&gt; -&gt; Series&lt;&#39;R,&#39;T&gt; (requires equality and equality)<br /><br />Full name: Deedle.Series.mapKeys</div>
<div class="tip" id="fs112">DateTimeOffset.Parse(input: string) : DateTimeOffset<br />DateTimeOffset.Parse(input: string, formatProvider: IFormatProvider) : DateTimeOffset<br />DateTimeOffset.Parse(input: string, formatProvider: IFormatProvider, styles: Globalization.DateTimeStyles) : DateTimeOffset</div>
<div class="tip" id="fs113">val sampled : Series&lt;DateTime,Series&lt;DateTimeOffset,float&gt;&gt;<br /><br />Full name: Series.sampled</div>
<div class="tip" id="fs114">val resampleUniform : fillMode:Lookup -&gt; keyProj:(&#39;K1 -&gt; &#39;K2) -&gt; nextKey:(&#39;K2 -&gt; &#39;K2) -&gt; series:Series&lt;&#39;K1,&#39;V&gt; -&gt; Series&lt;&#39;K2,Series&lt;&#39;K1,&#39;V&gt;&gt; (requires equality and comparison)<br /><br />Full name: Deedle.Series.resampleUniform</div>
<div class="tip" id="fs115">val dt : DateTimeOffset</div>
<div class="tip" id="fs116">val dt : DateTime</div>
<div class="tip" id="fs117">DateTime.AddDays(value: float) : DateTime</div>
<div class="tip" id="fs118">static member SeriesExtensions.ResampleUniform : series:Series&lt;&#39;K,&#39;V&gt; * keyProj:Func&lt;&#39;K,&#39;a2&gt; * nextKey:Func&lt;&#39;a2,&#39;a2&gt; -&gt; Series&lt;&#39;a2,&#39;V&gt; (requires equality and comparison)<br />static member SeriesExtensions.ResampleUniform : series:Series&lt;&#39;K1,&#39;V&gt; * keyProj:Func&lt;&#39;K1,&#39;K2&gt; * nextKey:Func&lt;&#39;K2,&#39;K2&gt; * fillMode:Lookup -&gt; Series&lt;&#39;K2,&#39;V&gt; (requires equality and comparison)</div>
<div class="tip" id="fs119">val mapValues : f:(&#39;T -&gt; &#39;R) -&gt; series:Series&lt;&#39;K,&#39;T&gt; -&gt; Series&lt;&#39;K,&#39;R&gt; (requires equality)<br /><br />Full name: Deedle.Series.mapValues</div>
<div class="tip" id="fs120">val indexOrdinally : series:Series&lt;&#39;K,&#39;T&gt; -&gt; Series&lt;int,&#39;T&gt; (requires equality)<br /><br />Full name: Deedle.Series.indexOrdinally</div>
<div class="tip" id="fs121">static member Frame.ofRows : rows:seq&lt;&#39;a0 * #ISeries&lt;&#39;a2&gt;&gt; -&gt; Frame&lt;&#39;a0,&#39;a2&gt; (requires equality and equality)<br />static member Frame.ofRows : rows:Series&lt;&#39;a0,#ISeries&lt;&#39;a2&gt;&gt; -&gt; Frame&lt;&#39;a0,&#39;a2&gt; (requires equality and equality)</div>
<div class="tip" id="fs122">val pr : Series&lt;DateTimeOffset,float&gt;<br /><br />Full name: Series.pr</div>
<div class="tip" id="fs123">val sampleTime : interval:TimeSpan -&gt; dir:Direction -&gt; series:Series&lt;&#39;a,&#39;b&gt; -&gt; Series&lt;&#39;a,Series&lt;&#39;a,&#39;b&gt;&gt; (requires equality and member ( + ))<br /><br />Full name: Deedle.Series.sampleTime</div>
<div class="tip" id="fs124">static member SeriesExtensions.Sample : series:Series&lt;&#39;K,&#39;V&gt; * keys:seq&lt;&#39;K&gt; -&gt; Series&lt;&#39;K,&#39;V&gt; (requires equality)<br />static member SeriesExtensions.Sample : series:Series&lt;DateTimeOffset,&#39;V&gt; * interval:TimeSpan -&gt; Series&lt;DateTimeOffset,&#39;V&gt;<br />static member SeriesExtensions.Sample : series:Series&lt;DateTimeOffset,&#39;V&gt; * interval:TimeSpan * dir:Direction -&gt; Series&lt;DateTimeOffset,&#39;V&gt;<br />static member SeriesExtensions.Sample : series:Series&lt;DateTimeOffset,&#39;V&gt; * start:DateTimeOffset * interval:TimeSpan * dir:Direction -&gt; Series&lt;DateTimeOffset,&#39;V&gt;</div>
<div class="tip" id="fs125">val sampleTimeInto : interval:TimeSpan -&gt; dir:Direction -&gt; f:(Series&lt;&#39;K,&#39;V&gt; -&gt; &#39;a) -&gt; series:Series&lt;&#39;K,&#39;V&gt; -&gt; Series&lt;&#39;K,&#39;a&gt; (requires equality and member ( + ))<br /><br />Full name: Deedle.Series.sampleTimeInto</div>
<div class="tip" id="fs126">val lastValue : series:Series&lt;&#39;K,&#39;V&gt; -&gt; &#39;V (requires equality)<br /><br />Full name: Deedle.Series.lastValue</div>
<div class="tip" id="fs127">val sample : Series&lt;DateTimeOffset,float&gt;<br /><br />Full name: Series.sample</div>
<div class="tip" id="fs128">val diff1 : Series&lt;DateTimeOffset,float&gt;<br /><br />Full name: Series.diff1</div>
<div class="tip" id="fs129">val diff : offset:int -&gt; series:Series&lt;&#39;K,&#39;T&gt; -&gt; Series&lt;&#39;K,&#39;T&gt; (requires equality and member ( - ))<br /><br />Full name: Deedle.Series.diff</div>
<div class="tip" id="fs130">val diffM1 : Series&lt;DateTimeOffset,float&gt;<br /><br />Full name: Series.diffM1</div>
<div class="tip" id="fs131">val shift1 : Series&lt;DateTimeOffset,float&gt;<br /><br />Full name: Series.shift1</div>
<div class="tip" id="fs132">val shift : offset:int -&gt; series:Series&lt;&#39;K,&#39;T&gt; -&gt; Series&lt;&#39;K,&#39;T&gt; (requires equality)<br /><br />Full name: Deedle.Series.shift</div>
<div class="tip" id="fs133">val df : Frame&lt;DateTimeOffset,string&gt;<br /><br />Full name: Series.df</div>
<div class="tip" id="fs134">static member SeriesExtensions.Shift : series:Series&lt;&#39;K,&#39;V&gt; * offset:int -&gt; Series&lt;&#39;K,&#39;V&gt; (requires equality)</div>
<div class="tip" id="fs135">val log : value:&#39;T -&gt; &#39;T (requires member Log)<br /><br />Full name: Microsoft.FSharp.Core.Operators.log</div>
<div class="tip" id="fs136">static member SeriesExtensions.Diff : series:Series&lt;&#39;K,float&gt; * offset:int -&gt; Series&lt;&#39;K,float&gt; (requires equality)</div>
<div class="tip" id="fs137">val abs : value:&#39;T -&gt; &#39;T (requires member Abs)<br /><br />Full name: Microsoft.FSharp.Core.Operators.abs</div>
<div class="tip" id="fs138">val adjust : v:float -&gt; float<br /><br />Full name: Series.adjust</div>
<div class="tip" id="fs139">val v : float</div>
<div class="tip" id="fs140">val min : e1:&#39;T -&gt; e2:&#39;T -&gt; &#39;T (requires comparison)<br /><br />Full name: Microsoft.FSharp.Core.Operators.min</div>
<div class="tip" id="fs141">val max : e1:&#39;T -&gt; e2:&#39;T -&gt; &#39;T (requires comparison)<br /><br />Full name: Microsoft.FSharp.Core.Operators.max</div>
<div class="tip" id="fs142">val conv : x:float -&gt; float<br /><br />Full name: Series.conv<br /><em><br /><br />&#160;すべての数値列を特定の定数倍にします</em></div>
<div class="tip" id="fs143">val x : float</div>
<div class="tip" id="fs144">val mapRowValues : f:(ObjectSeries&lt;&#39;C&gt; -&gt; &#39;V) -&gt; frame:Frame&lt;&#39;R,&#39;C&gt; -&gt; Series&lt;&#39;R,&#39;V&gt; (requires equality and equality)<br /><br />Full name: Deedle.Frame.mapRowValues</div>
<div class="tip" id="fs145">val os : ObjectSeries&lt;string&gt;</div>
<div class="tip" id="fs146">member ObjectSeries.As : unit -&gt; Series&lt;&#39;K,&#39;R&gt;</div>
<div class="tip" id="fs147">Multiple items<br />val float : value:&#39;T -&gt; float (requires member op_Explicit)<br /><br />Full name: Microsoft.FSharp.Core.Operators.float<br /><br />--------------------<br />type float = Double<br /><br />Full name: Microsoft.FSharp.Core.float<br /><br />--------------------<br />type float&lt;&#39;Measure&gt; = float<br /><br />Full name: Microsoft.FSharp.Core.float&lt;_&gt;</div>
<div class="tip" id="fs148">static member Stats.sum : frame:Frame&lt;&#39;R,&#39;C&gt; -&gt; Series&lt;&#39;C,float&gt; (requires equality and equality)<br />static member Stats.sum : series:Series&lt;&#39;K,float&gt; -&gt; float (requires equality)</div>

        </div>
        <div class="span3">
          <a href="/Deedle/ja/index.html">
            <img src="/Deedle/ja/../images/logo.png" style="width:140px;height:140px;margin:10px 0px 0px 35px;border-style:none;" />
          </a>

          <ul class="nav nav-list" id="menu">
            <li class="nav-header">Deedle</li>
            <li><a href="/Deedle/ja/index.html">ホームページ</a></li>
            <li class="divider"></li>
            <li><a href="https://nuget.org/packages/Deedle">NuGet経由でライブラリを取得</a></li>
            <li><a href="http://github.com/BlueMountainCapital/Deedle">GitHub上のソースコード</a></li>
            <li><a href="http://github.com/BlueMountainCapital/Deedle/blob/master/LICENSE.md">ライセンス</a></li>
            <li><a href="http://github.com/BlueMountainCapital/Deedle/blob/master/RELEASE_NOTES.md">リリースノート</a></li>
            <li><a href="/Deedle/ja/design.html">デザインノート</a></li>
            <li><a href="http://stackoverflow.com/questions/tagged/deedle">質問する！</a></li>
            
            <li class="nav-header">F#で使用する</li>
            <li>
              <a href="/Deedle/ja/tutorial.html">クイックスタートチュートリアル</a>
            </li>
            <li>
              <a href="/Deedle/ja/series.html">時系列の処理</a>
              <ul class="nav nav-list">
                <li><a href="/Deedle/ja/series.html#alignment">アライメントと連結</a></li>
                <li><a href="/Deedle/ja/series.html#windowing">ウィンドウとチャンク</a></li>
                <li><a href="/Deedle/ja/series.html#sampling">ルックアップとリサンプリング</a></li>
                <li><a href="/Deedle/ja/series.html#stats">統計と数学</a></li>
              </ul>
            </li>
            <li>
              <a href="/Deedle/ja/frame.html">データフレームの処理</a>
            </li>
            <li>
              <a href="/Deedle/ja/stats.html">統計および計算</a>
            </li>
            <li>
              <a href="/Deedle/ja/rinterop.html">RとDeedleを組み合わせる</a>
            </li>

            <li class="nav-header">C#で使用する</li>
            <li><a href="/Deedle/ja/csharpintro.html">はじめに</a></li>
            <li>
              <a href="/Deedle/ja/csharpseries.html">時系列データの処理</a>
            </li>
            <li>
              <a href="/Deedle/ja/csharpframe.html">データフレームの処理</a>
            </li>

            <li class="nav-header">ドキュメント</li>
            <li><a href="/Deedle/ja/../reference/index.html">APIリファレンス(En)</a></li>
            <li class="divider"></li>
            <li><a href="/Deedle/ja/../reference/deedle-seriesmodule.html">Series モジュール</a></li>
            <li><a href="/Deedle/ja/../reference/deedle-framemodule.html">Frame モジュール</a></li>
            <li><a href="/Deedle/ja/../reference/deedle-stats.html">Stats モジュール</a></li>

            <li class="nav-header">サンプル</li>
            <li><a href="/Deedle/ja/lazysource.html">遅延データ読み込み</a></li>
          </ul>
        </div>
      </div>
    </div>
    <a href="http://github.com/BlueMountainCapital/Deedle"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"></a>
    <script>
      (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
          (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date(); a = s.createElement(o),
        m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
      })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
      ga('create', 'UA-45379232-1', 'bluemountaincapital.github.io');
      ga('send', 'pageview');
    </script>
  </body>
</html>